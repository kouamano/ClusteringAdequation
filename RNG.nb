(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     14231,        453]
NotebookOptionsPosition[     12467,        385]
NotebookOutlinePosition[     12852,        402]
CellTagsIndexPosition[     12809,        399]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Relative neighborhood graph", "Title",
 CellChangeTimes->{{3.59131047241404*^9, 3.591310477905962*^9}}],

Cell[CellGroupData[{

Cell["Program", "Section",
 CellChangeTimes->{{3.591310808199294*^9, 3.591310809253953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lun", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_", ",", "q_"}], "}"}], ",", "dmat_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"len", ",", "z", ",", "zlen"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "dmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "len", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zlen", "=", 
      RowBox[{"Length", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Or", ",", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", 
               RowBox[{"z", "[", 
                RowBox[{"[", "zi", "]"}], "]"}]}], "]"}], "]"}], "<", 
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"[", "zi", "]"}], "]"}], ",", "q"}], "]"}], "]"}], 
            "<", 
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"zi", ",", "zlen"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.599984424720107*^9, 3.59998446775735*^9}, {
  3.599984575549934*^9, 3.5999845790952806`*^9}, {3.599984738750655*^9, 
  3.599984776548555*^9}, {3.599984987395884*^9, 3.5999850095016613`*^9}, {
  3.599985072147751*^9, 3.5999852144844112`*^9}, {3.599985282516264*^9, 
  3.599985309589676*^9}, {3.59998546231301*^9, 3.599985480205792*^9}, {
  3.5999855450927773`*^9, 3.599985551360244*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data", "Section",
 CellChangeTimes->{{3.591310808199294*^9, 3.591310822714167*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "10"}]], "Input",
 CellChangeTimes->{{3.5999827289090548`*^9, 3.5999827338575*^9}, {
  3.599984813450295*^9, 3.5999848145878477`*^9}, {3.599985237934608*^9, 
  3.599985238058609*^9}}],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{3.599982734585897*^9, 3.599984815462852*^9, 
  3.5999849126413307`*^9, 3.5999852401618767`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"a", "+", "b"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.599982010659634*^9, 3.599982037740028*^9}, {
  3.599982333300908*^9, 3.599982336850006*^9}, {3.599982738440773*^9, 
  3.599982739417865*^9}, {3.59998490939561*^9, 3.599984909693975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dmat", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"EuclideanDistance", ",", "test", ",", "test", ",", "1"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59998223690307*^9, 3.5999822927583647`*^9}, 
   3.599982759779565*^9, 3.599984823147729*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pair", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.599982163718563*^9, 3.599982206965043*^9}, {
  3.5999823673706017`*^9, 3.599982379399053*^9}, {3.599982745478777*^9, 
  3.599982746576118*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pair", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.5999835173973227`*^9, 3.59998353455902*^9}, {
  3.599984957519649*^9, 3.5999849586765833`*^9}}],

Cell[BoxData["90"], "Output",
 CellChangeTimes->{{3.599983525477248*^9, 3.599983535225771*^9}, 
   3.599984898631421*^9, 3.599984959406228*^9, 3.59998524912162*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"lun", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_", ",", "q_"}], "}"}], ",", "dmat_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"len", ",", "z", ",", "zlen"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "dmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "len", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zlen", "=", 
      RowBox[{"Length", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Or", ",", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", 
               RowBox[{"z", "[", 
                RowBox[{"[", "zi", "]"}], "]"}]}], "]"}], "]"}], "<", 
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"[", "zi", "]"}], "]"}], ",", "q"}], "]"}], "]"}], 
            "<", 
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"zi", ",", "zlen"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.599984424720107*^9, 3.59998446775735*^9}, {
  3.599984575549934*^9, 3.5999845790952806`*^9}, {3.599984738750655*^9, 
  3.599984776548555*^9}, {3.599984987395884*^9, 3.5999850095016613`*^9}, {
  3.599985072147751*^9, 3.5999852144844112`*^9}, {3.599985282516264*^9, 
  3.599985309589676*^9}, {3.59998546231301*^9, 3.599985480205792*^9}, {
  3.5999855450927773`*^9, 3.599985551360244*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3"}], "}"}]], "Input",
 CellChangeTimes->{{3.599983801810132*^9, 3.599983803954056*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"lun", "[", 
     RowBox[{"#", ",", "dmat"}], "]"}], "&"}], ",", "pair"}], "]"}]], "Input",\

 CellChangeTimes->{{3.5999852585475187`*^9, 3.599985301643124*^9}, {
  3.599985582655171*^9, 3.599985623521325*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "False", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "False", ",", "False", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "False", ",", "False", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "False", ",", "False", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "False", 
   ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "False", ",", "False", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "False", ",", "False", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "False", ",", "False", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.599985623959302*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.591310808199294*^9, 3.591310822714167*^9}, {
  3.5999856460732203`*^9, 3.599985651431315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"dmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"z", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "<", 
    RowBox[{"dmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"dmat", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], "]"}], "<", 
    RowBox[{"dmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.599983809769319*^9, 3.599983858551227*^9}, {
  3.5999841365274553`*^9, 3.599984213540307*^9}, {3.599984286181529*^9, 
  3.5999842886026497`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.599983829903872*^9, 3.599984139404461*^9, {3.5999841965751743`*^9, 
   3.5999842143123207`*^9}, 3.599984289098325*^9, 3.5999850636951838`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dmat", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", 
    RowBox[{"z", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.599984272700356*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dmat", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "3"}], "]"}], "]"}]], "Input"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.599984279822191*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"dmat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", 
      RowBox[{"z", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "<", 
   RowBox[{"dmat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.599984228607828*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"dmat", "[", 
    RowBox[{
     RowBox[{"z", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], "<", 
   RowBox[{"dmat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0", ",", "2", ",", "4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "0", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4", ",", "2", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "6", ",", "4", ",", "2", ",", "0"}], "}"}]}], "}"}], 
   "[", 
   RowBox[{"2", ",", "3"}], "]"}], "<", "4"}]], "Output",
 CellChangeTimes->{3.5999842354326878`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Or", "[", 
  RowBox[{"False", ",", "False", ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.599985502824616*^9, 3.59998551571143*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.599985516520113*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{740, 853},
WindowMargins->{{14, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (2013\:5e741\
\:670828\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 109, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[713, 27, 92, 1, 80, "Section"],
Cell[808, 30, 2181, 57, 148, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3026, 92, 89, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[3140, 97, 216, 4, 28, "Input"],
Cell[3359, 103, 144, 2, 28, "Output"]
}, Open  ]],
Cell[3518, 108, 479, 12, 28, "Input"],
Cell[4000, 122, 290, 7, 28, "Input"],
Cell[4293, 131, 446, 12, 28, "Input"],
Cell[CellGroupData[{
Cell[4764, 147, 176, 3, 28, "Input"],
Cell[4943, 152, 164, 2, 28, "Output"]
}, Open  ]],
Cell[5122, 157, 2181, 57, 148, "Input"],
Cell[7306, 216, 138, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[7469, 223, 281, 8, 28, "Input"],
Cell[7753, 233, 1350, 20, 148, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9152, 259, 143, 2, 80, "Section"],
Cell[CellGroupData[{
Cell[9320, 265, 780, 24, 28, "Input"],
Cell[10103, 291, 198, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10338, 299, 160, 5, 28, "Input"],
Cell[10501, 306, 70, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10608, 312, 104, 3, 28, "Input"],
Cell[10715, 317, 70, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10822, 323, 298, 10, 28, "Input"],
Cell[11123, 335, 73, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11233, 341, 270, 9, 28, "Input"],
Cell[11506, 352, 644, 17, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12187, 374, 164, 3, 28, "Input"],
Cell[12354, 379, 73, 1, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
