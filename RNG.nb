(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     29939,        910]
NotebookOptionsPosition[     27229,        810]
NotebookOutlinePosition[     27595,        826]
CellTagsIndexPosition[     27552,        823]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Relative neighborhood graph", "Title",
 CellChangeTimes->{{3.59131047241404*^9, 3.591310477905962*^9}}],

Cell[CellGroupData[{

Cell["Program", "Section",
 CellChangeTimes->{{3.591310808199294*^9, 3.591310809253953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lun", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_", ",", "q_"}], "}"}], ",", "dmat_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"len", ",", "z", ",", "zlen"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "dmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "len", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zlen", "=", 
      RowBox[{"Length", "[", "z", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Or", ",", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", 
               RowBox[{"z", "[", 
                RowBox[{"[", "zi", "]"}], "]"}]}], "]"}], "]"}], "<", 
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"[", "zi", "]"}], "]"}], ",", "q"}], "]"}], "]"}], 
            "<", 
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"zi", ",", "zlen"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.599984424720107*^9, 3.59998446775735*^9}, {
  3.599984575549934*^9, 3.5999845790952806`*^9}, {3.599984738750655*^9, 
  3.599984776548555*^9}, {3.599984987395884*^9, 3.5999850095016613`*^9}, {
  3.599985072147751*^9, 3.5999852144844112`*^9}, {3.599985282516264*^9, 
  3.599985309589676*^9}, {3.59998546231301*^9, 3.599985480205792*^9}, {
  3.5999855450927773`*^9, 3.599985551360244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lun", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_", ",", "q_"}], "}"}], ",", "dmat_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"len", ",", "range", ",", "z", ",", "zlen"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "dmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"range", "=", 
      RowBox[{"Range", "[", "len", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{"range", ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "q"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zlen", "=", 
      RowBox[{"len", "-", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Or", ",", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", 
               RowBox[{"z", "[", 
                RowBox[{"[", "zi", "]"}], "]"}]}], "]"}], "]"}], "<", 
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"z", "[", 
                RowBox[{"[", "zi", "]"}], "]"}], ",", "q"}], "]"}], "]"}], 
            "<", 
            RowBox[{"dmat", "[", 
             RowBox[{"[", 
              RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"zi", ",", "zlen"}], "}"}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.599984424720107*^9, 3.59998446775735*^9}, {
  3.599984575549934*^9, 3.5999845790952806`*^9}, {3.599984738750655*^9, 
  3.599984776548555*^9}, {3.599984987395884*^9, 3.5999850095016613`*^9}, {
  3.599985072147751*^9, 3.5999852144844112`*^9}, {3.599985282516264*^9, 
  3.599985309589676*^9}, {3.59998546231301*^9, 3.599985480205792*^9}, {
  3.5999855450927773`*^9, 3.599985551360244*^9}, {3.6004630019443417`*^9, 
  3.600463056322878*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rngSelectionTest", "[", "dmat_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "len", ",", "range", ",", "z", ",", "zlen", ",", "pair", ",", "tests"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"len", "=", 
      RowBox[{"Length", "[", "dmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"range", "=", 
      RowBox[{"Range", "[", "len", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"z", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"range", ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "q"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"zlen", "=", 
      RowBox[{"len", "-", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pair", "=", 
      RowBox[{"Permutations", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "len"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tests", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{"range", ",", "#"}], "]"}]}], "}"}], "&"}], ",", "pair"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dmat", "[", 
            RowBox[{"[", 
             RowBox[{"p", ",", 
              RowBox[{"z", "[", 
               RowBox[{"[", "zi", "]"}], "]"}]}], "]"}], "]"}], "<", 
           RowBox[{"dmat", "[", 
            RowBox[{"[", 
             RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dmat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"z", "[", 
               RowBox[{"[", "zi", "]"}], "]"}], ",", "q"}], "]"}], "]"}], "<", 
           RowBox[{"dmat", "[", 
            RowBox[{"[", 
             RowBox[{"p", ",", "q"}], "]"}], "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"zi", ",", "zlen"}], "}"}]}], "]"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dmat", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "<", 
             RowBox[{"dmat", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dmat", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], "<", 
             
             RowBox[{"dmat", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
            ")"}]}], "&"}], ",", "tests"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"dmat", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", "<", 
                RowBox[{"dmat", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], 
                 "]"}]}]}]}], "]"}], ",", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"dmat", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", "<", 
                RowBox[{"dmat", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], 
                 "]"}]}]}]}], "]"}]}], "}"}], "&"}], ",", "tests"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6004633701210213`*^9, 3.600463462421569*^9}, {
   3.6004635088544827`*^9, 3.6004635215826283`*^9}, 3.600463672916868*^9, {
   3.600464294967401*^9, 3.6004644030789213`*^9}, {3.600464481559943*^9, 
   3.600464615167028*^9}, {3.6004648974152527`*^9, 3.6004649002836323`*^9}, 
   3.6004649537841377`*^9, {3.6004650451572742`*^9, 3.600465100145752*^9}, {
   3.6004651377943773`*^9, 3.600465161529799*^9}, {3.600465291678398*^9, 
   3.600465300541555*^9}, {3.600465631448276*^9, 3.600465685173078*^9}, {
   3.600465756723555*^9, 3.600465783186911*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "6", ",", "8"}], "}"}], ",", 
   RowBox[{"x_", "/;", 
    RowBox[{"x", "<", "5"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6004648400925913`*^9, 3.600464879886631*^9}, {
  3.600464924621738*^9, 3.600464946076373*^9}}],

Cell[BoxData[
 RowBox[{"{", "4", "}"}]], "Output",
 CellChangeTimes->{{3.600464867048663*^9, 3.6004648826694508`*^9}, {
  3.6004649353456097`*^9, 3.600464946698291*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data", "Section",
 CellChangeTimes->{{3.591310808199294*^9, 3.591310822714167*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "7"}]], "Input",
 CellChangeTimes->{{3.5999827289090548`*^9, 3.5999827338575*^9}, {
   3.599984813450295*^9, 3.5999848145878477`*^9}, {3.599985237934608*^9, 
   3.599985238058609*^9}, {3.600463137866218*^9, 3.600463165773761*^9}, {
   3.6004634806028843`*^9, 3.6004634821068487`*^9}, {3.600463840852953*^9, 
   3.600463841360613*^9}, 3.600465245055852*^9, {3.600465342017375*^9, 
   3.600465343028023*^9}, {3.6004654971277122`*^9, 3.6004654973091288`*^9}, {
   3.600465600340665*^9, 3.600465602311699*^9}, {3.600465853408389*^9, 
   3.600465897574366*^9}, {3.600465930442514*^9, 3.600465930868437*^9}, {
   3.6004661059262466`*^9, 3.600466107555996*^9}, 3.6004672249908*^9, {
   3.600467274331554*^9, 3.6004672758448877`*^9}, {3.600467313222684*^9, 
   3.6004673142248993`*^9}, {3.6004673780404263`*^9, 3.600467379963951*^9}, {
   3.600467645050105*^9, 3.6004676458245068`*^9}, {3.600468390019124*^9, 
   3.6004683949530897`*^9}}],

Cell[BoxData["7"], "Output",
 CellChangeTimes->{
  3.599982734585897*^9, 3.599984815462852*^9, 3.5999849126413307`*^9, 
   3.5999852401618767`*^9, 3.600462716358617*^9, {3.600463131529955*^9, 
   3.600463169705838*^9}, 3.600463485502673*^9, 3.6004638417875834`*^9, 
   3.6004646254832153`*^9, 3.60046511101908*^9, 3.6004651665969973`*^9, 
   3.600465249769247*^9, 3.600465348905518*^9, 3.600465502116572*^9, {
   3.600465602765785*^9, 3.600465609672163*^9}, {3.6004658646269712`*^9, 
   3.600465901902102*^9}, 3.600465934809327*^9, 3.600466111600786*^9, 
   3.600467228435382*^9, 3.6004672791440287`*^9, 3.60046731845319*^9, 
   3.600467384862502*^9, 3.600467650715479*^9, 3.6004683988923893`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"a", "+", "b"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.599982010659634*^9, 3.599982037740028*^9}, {
  3.599982333300908*^9, 3.599982336850006*^9}, {3.599982738440773*^9, 
  3.599982739417865*^9}, {3.59998490939561*^9, 3.599984909693975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dmat", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"EuclideanDistance", ",", "test", ",", "test", ",", "1"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.59998223690307*^9, 3.5999822927583647`*^9}, 
   3.599982759779565*^9, 3.599984823147729*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pair", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.599982163718563*^9, 3.599982206965043*^9}, {
  3.5999823673706017`*^9, 3.599982379399053*^9}, {3.599982745478777*^9, 
  3.599982746576118*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pair", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.5999835173973227`*^9, 3.59998353455902*^9}, {
   3.599984957519649*^9, 3.5999849586765833`*^9}, {3.600463490305725*^9, 
   3.600463492102221*^9}, 3.600465321869137*^9, {3.6004684025078297`*^9, 
   3.600468406617878*^9}}],

Cell[BoxData["42"], "Output",
 CellChangeTimes->{3.600468408067914*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rngSelectionTest", "[", "dmat", "]"}]], "Input",
 CellChangeTimes->{3.6004658610293016`*^9, 3.600468415166169*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "7", "}"}], ",", 
   RowBox[{"{", "8", "}"}], ",", 
   RowBox[{"{", "14", "}"}], ",", 
   RowBox[{"{", "15", "}"}], ",", 
   RowBox[{"{", "21", "}"}], ",", 
   RowBox[{"{", "22", "}"}], ",", 
   RowBox[{"{", "28", "}"}], ",", 
   RowBox[{"{", "29", "}"}], ",", 
   RowBox[{"{", "35", "}"}], ",", 
   RowBox[{"{", "36", "}"}], ",", 
   RowBox[{"{", "42", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6004684157484283`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"rngSelectionTest", "[", "dmat", "]"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.600464413840192*^9, 3.6004644213382187`*^9}, {
  3.600465309651389*^9, 3.6004653352159033`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00699900000000000001298960938811433152`3.865635906793039", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.600464422414444*^9, 3.600464627209837*^9, 3.600465111776926*^9, 
   3.6004651685043507`*^9, 3.6004652537236156`*^9, {3.600465317105048*^9, 
   3.600465356576435*^9}, 3.6004655456355333`*^9, 3.6004656125134277`*^9, 
   3.600465707816738*^9, 3.600465793323015*^9, {3.600465870080895*^9, 
   3.600465915228819*^9}, 3.6004660234831343`*^9, 3.60046640797272*^9, 
   3.600467233595416*^9, 3.6004672862276173`*^9, 3.6004673403685703`*^9, 
   3.6004675351621037`*^9, 3.600467887822596*^9, 3.6004684031379213`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"lun", "[", 
       RowBox[{"#", ",", "dmat"}], "]"}], "&"}], ",", "pair"}], "]"}], ",", 
   "False"}], "]"}]], "Input",
 CellChangeTimes->{{3.600468439296495*^9, 3.600468447615841*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "7", "}"}], ",", 
   RowBox[{"{", "8", "}"}], ",", 
   RowBox[{"{", "14", "}"}], ",", 
   RowBox[{"{", "15", "}"}], ",", 
   RowBox[{"{", "21", "}"}], ",", 
   RowBox[{"{", "22", "}"}], ",", 
   RowBox[{"{", "28", "}"}], ",", 
   RowBox[{"{", "29", "}"}], ",", 
   RowBox[{"{", "35", "}"}], ",", 
   RowBox[{"{", "36", "}"}], ",", 
   RowBox[{"{", "42", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.600468428447158*^9, 3.6004684483646717`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lun", "[", 
         RowBox[{"#", ",", "dmat"}], "]"}], "&"}], ",", "pair"}], "]"}], ",", 
     "False"}], "]"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.600468439296495*^9, 3.600468447615841*^9}, {
  3.600468478719639*^9, 3.600468489627273*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Section",
 CellChangeTimes->{{3.591310808199294*^9, 3.591310822714167*^9}, {
  3.5999856460732203`*^9, 3.599985651431315*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"30", ",", 
   RowBox[{"{", 
    RowBox[{
    "0.17897299999999999320365873245464172214`5.273387431212257", ",", 
     "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14597799999999999664979100089112762362`5.184887322498772", ",", 
     "Null"}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.600467239900591*^9, 3.6004672617504063`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"30", ",", 
   RowBox[{"{", 
    RowBox[{
    "0.17897299999999999320365873245464172214`5.273387431212257", ",", 
     "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14597799999999999664979100089112762362`5.184887322498772", ",", 
     "Null"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6004672636535587`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"60", ",", 
   RowBox[{"{", 
    RowBox[{
    "1.25480900000000006322409262793371453881`6.1191775382529885", ",", 
     "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.91786000000000000920152842809329740703`5.983376357156033", ",", 
     "Null"}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.600467285633424*^9, 3.600467306409678*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"60", ",", 
   RowBox[{"{", 
    RowBox[{
    "1.25480900000000006322409262793371453881`6.1191775382529885", ",", 
     "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.91786000000000000920152842809329740703`5.983376357156033", ",", 
     "Null"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.600467308063768*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"120", ",", 
   RowBox[{"{", 
    RowBox[{
    "9.53155100000000032878233469091355800629`6.999763489252074", ",", 
     "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6.71197999999999961318053465220145881176`6.847450567014663", ",", 
     "Null"}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.600467329025166*^9, 3.600467369198626*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"120", ",", 
   RowBox[{"{", 
    RowBox[{
    "9.53155100000000032878233469091355800629`6.999763489252074", ",", 
     "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "6.71197999999999961318053465220145881176`6.847450567014663", ",", 
     "Null"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6004673706520452`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"240", ",", 
   RowBox[{"{", 
    RowBox[{
    "74.31470199999999692863639211282134056091`7.891674653902184", ",", 
     "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "52.12507599999999996498445398174226284027`7.737646614476912", ",", 
     "Null"}], "}"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.600467606371011*^9, 3.600467625226633*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"240", ",", 
   RowBox[{"{", 
    RowBox[{
    "74.31470199999999692863639211282134056091`7.891674653902184", ",", 
     "Null"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "52.12507599999999996498445398174226284027`7.737646614476912", ",", 
     "Null"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.600467629178924*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"dmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"z", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "<", 
    RowBox[{"dmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"dmat", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], "]"}], "<", 
    RowBox[{"dmat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.599983809769319*^9, 3.599983858551227*^9}, {
  3.5999841365274553`*^9, 3.599984213540307*^9}, {3.599984286181529*^9, 
  3.5999842886026497`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.599983829903872*^9, 3.599984139404461*^9, {3.5999841965751743`*^9, 
   3.5999842143123207`*^9}, 3.599984289098325*^9, 3.5999850636951838`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dmat", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", 
    RowBox[{"z", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.599984272700356*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dmat", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "3"}], "]"}], "]"}]], "Input"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.599984279822191*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"dmat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", 
      RowBox[{"z", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "<", 
   RowBox[{"dmat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.599984228607828*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{"dmat", "[", 
    RowBox[{
     RowBox[{"z", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], "<", 
   RowBox[{"dmat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ")"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "4", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0", ",", "2", ",", "4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2", ",", "0", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4", ",", "2", ",", "0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "6", ",", "4", ",", "2", ",", "0"}], "}"}]}], "}"}], 
   "[", 
   RowBox[{"2", ",", "3"}], "]"}], "<", "4"}]], "Output",
 CellChangeTimes->{3.5999842354326878`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Or", "[", 
  RowBox[{"False", ",", "False", ",", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.599985502824616*^9, 3.59998551571143*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.599985516520113*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"lun", "[", 
     RowBox[{"#", ",", "dmat"}], "]"}], "&"}], ",", "pair"}], "]"}]], "Input",\

 CellChangeTimes->{{3.5999852585475187`*^9, 3.599985301643124*^9}, {
  3.599985582655171*^9, 3.599985623521325*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "False", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "False", ",", "False", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "False", ",", "False", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "False", ",", "False", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "False", 
   ",", "False", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "True", ",", "False", ",", "False", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "True", ",", "False", ",", "False", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True", ",", "False", ",", "False", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.599985623959302*^9, 3.600462749642218*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{740, 853},
WindowMargins->{{Automatic, 202}, {Automatic, 45}},
ShowSelection->True,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (2013\:5e742\:67081\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 109, 1, 93, "Title"],
Cell[CellGroupData[{
Cell[713, 27, 92, 1, 81, "Section"],
Cell[808, 30, 2181, 57, 187, "Input"],
Cell[2992, 89, 2303, 59, 209, "Input"],
Cell[5298, 150, 6765, 180, 451, "Input"],
Cell[CellGroupData[{
Cell[12088, 334, 308, 8, 32, "Input"],
Cell[12399, 344, 169, 3, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12617, 353, 89, 1, 81, "Section"],
Cell[CellGroupData[{
Cell[12731, 358, 963, 14, 32, "Input"],
Cell[13697, 374, 697, 10, 32, "Output"]
}, Open  ]],
Cell[14409, 387, 479, 12, 32, "Input"],
Cell[14891, 401, 290, 7, 32, "Input"],
Cell[15184, 410, 446, 12, 32, "Input"],
Cell[CellGroupData[{
Cell[15655, 426, 301, 5, 32, "Input"],
Cell[15959, 433, 71, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16067, 439, 138, 2, 32, "Input"],
Cell[16208, 443, 514, 15, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16759, 463, 243, 5, 32, "Input"],
Cell[17005, 470, 669, 12, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17711, 487, 303, 9, 32, "Input"],
Cell[18017, 498, 538, 15, 32, "Output"]
}, Open  ]],
Cell[18570, 516, 418, 12, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19025, 533, 143, 2, 81, "Section"],
Cell[CellGroupData[{
Cell[19193, 539, 391, 11, 99, "Input"],
Cell[19587, 552, 368, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19992, 568, 390, 11, 99, "Input"],
Cell[20385, 581, 367, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20789, 597, 390, 11, 99, "Input"],
Cell[21182, 610, 369, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21588, 626, 392, 11, 99, "Input"],
Cell[21983, 639, 369, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22389, 655, 780, 24, 55, "Input"],
Cell[23172, 681, 198, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23407, 689, 160, 5, 32, "Input"],
Cell[23570, 696, 70, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23677, 702, 104, 3, 32, "Input"],
Cell[23784, 707, 70, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23891, 713, 298, 10, 32, "Input"],
Cell[24192, 725, 73, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24302, 731, 270, 9, 32, "Input"],
Cell[24575, 742, 644, 17, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25256, 764, 164, 3, 32, "Input"],
Cell[25423, 769, 73, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25533, 775, 281, 8, 32, "Input"],
Cell[25817, 785, 1372, 20, 209, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
