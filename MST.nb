(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33523,       1083]
NotebookOptionsPosition[     30103,        963]
NotebookOutlinePosition[     30467,        979]
CellTagsIndexPosition[     30424,        976]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MST", "Title",
 CellChangeTimes->{{3.628160269255198*^9, 3.62816026980333*^9}, 
   3.628160311231175*^9, {3.628308923551476*^9, 3.628308935227256*^9}, {
   3.62837182524752*^9, 3.628371825773121*^9}}],

Cell[CellGroupData[{

Cell["Dir", "Section",
 CellChangeTimes->{{3.6283102925010443`*^9, 3.6283103050350122`*^9}, {
  3.628370162547789*^9, 3.62837017252008*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "SetDirectory", "[", 
   "\"\</home/kamano/gitsrc/ClusteringAdequation/test-data\>\"", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.628370174766938*^9, 3.628370190329344*^9}, {
  3.6284790983262043`*^9, 3.6284791014958267`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/kouamano/gitsrc/ClusteringAdequation/test-data\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.628370174766938*^9, 3.628370190329344*^9}, {
  3.628479104953032*^9, 3.628479116231901*^9}}],

Cell[BoxData["\<\"/Users/kouamano/gitsrc/ClusteringAdequation/test-data\"\>"],\
 "Output",
 CellChangeTimes->{3.628479119424477*^9, 3.628480533116846*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Program", "Section",
 CellChangeTimes->{{3.6283102925010443`*^9, 3.6283103050350122`*^9}, {
  3.628371762228101*^9, 3.628371775501588*^9}}],

Cell[BoxData[
 RowBox[{"Get", "[", 
  "\"\</Users/kouamano/gitsrc/MATH_SCRIPT/SCRIPTS/Network_operations.txt\>\"",
   "]"}]], "Input",
 CellChangeTimes->{{3.628479126262309*^9, 3.628479146663954*^9}}],

Cell["\<\
/home/kamano/gitsrc/MATH_SCRIPT/SCRIPTS/Network_operations.txt  \:306b\:79fb\
\:884c\:3002\
\>", "Text",
 CellChangeTimes->{{3.6283717787879553`*^9, 3.628371809343371*^9}}],

Cell["edge uniq:", "Text",
 CellChangeTimes->{{3.628225998624545*^9, 3.6282260093843517`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"udEdgeTake", "[", "dmat_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sort", "[", "#2", "]"}], ",", "#1"}], "}"}], "&"}], 
            ",", "dmat", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_"}], "}"}], ",", "_"}], "}"}], "/;", 
         RowBox[{"x", "\[NotEqual]", "y"}]}]}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "<", 
       RowBox[{"#2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.628219152382422*^9, 3.628219215502149*^9}, {
  3.6284768301789713`*^9, 3.628476834656011*^9}}],

Cell["Closeed path test:", "Text",
 CellChangeTimes->{{3.6282261109458447`*^9, 3.628226135992248*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"mstCycleTest", "[", "mst_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nEdge", ",", "nNode"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nEdge", "=", 
       RowBox[{"Length", "[", "mst", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nNode", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "mst"}], "]"}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"{", 
        RowBox[{"nEdge", ",", "nNode"}], "}"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nEdge", "<", "nNode"}], ",", "True", ",", "False"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.628219586820119*^9, 3.628219619560416*^9}, {
  3.628219699292264*^9, 3.6282197754758997`*^9}, {3.6282198361777*^9, 
  3.628220085208765*^9}, {3.6282201366132936`*^9, 3.6282201857507343`*^9}, {
  3.628220314669671*^9, 3.628220342681267*^9}, {3.6282207537503777`*^9, 
  3.628220774144598*^9}, {3.628221633281517*^9, 3.628221641684012*^9}, {
  3.628476838171686*^9, 3.6284768410496883`*^9}}],

Cell["addOpenPath:", "Text",
 CellChangeTimes->{{3.6282261429136887`*^9, 3.628226151332459*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"mstAddTest", "[", 
    RowBox[{"mstANDpoolPos_", ",", "edgePool_", ",", "size_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mst", ",", "mstNew", ",", "poolPos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mst", "=", 
       RowBox[{"mstANDpoolPos", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"poolPos", "=", 
       RowBox[{"mstANDpoolPos", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mstNew", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"mst", ",", 
         RowBox[{"{", 
          RowBox[{"edgePool", "[", 
           RowBox[{"[", 
            RowBox[{"poolPos", "+", "1"}], "]"}], "]"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"mstCycleTest", "[", "mst", "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mstCycleTest", "[", "mstNew", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"mstNew", ",", 
          RowBox[{"poolPos", "+", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mst", ",", 
          RowBox[{"poolPos", "+", "1"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{"mstNew", ",", 
       RowBox[{"poolPos", "+", "1"}], ",", "edgePool", ",", "size"}], "}"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "mstNew", "*)"}], "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQfe3L4Xx3jteOZ7I0S0F0xsEJNWB+bUE9iK5ZWtYJ
opU8lLpANP9/H2sPIF390iEIRNcF3YoB0U7THoLpYs/qVBBtwvstDUSv4N1b
AKL5GqUKQfSculOlIPqBzuZyEL3tVvwyEJ1nsngNiHbQnXMMRMsYbwDTG5ja
HoLoKO8FYPri6a0cnkD6mMpOfhDN4KUrDaJbmM3lQXRe7TotEC3ly6wLol9E
vc8D0e+Yc8pAdHX0jwYQ/WyvfyOI1rY3WgqiH9ZwrwHRk3fe3giis9IqNoPo
PXdX7gbRTN7r94BoD9/qgyB61bPWQyB6hl7NCRB9idH3HIjusdt4GURz3jsC
pidbtjoXA+mEpBN+IPqdz40IED1/UlokiN5n0md6FKSem9EMRAMA+UOuAQ==

  "]],

Cell["create first argment:", "Text",
 CellChangeTimes->{{3.62822617227632*^9, 3.6282261999081173`*^9}, {
  3.628309613098043*^9, 3.628309622544286*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"mstCreateFirst", "[", "edgePool_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"edgePool", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "1"}], "}"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.628309628784593*^9, 3.6283096874485893`*^9}, {
  3.628476851883436*^9, 3.628476855895732*^9}}],

Cell["get node size:", "Text",
 CellChangeTimes->{{3.62822617227632*^9, 3.6282261999081173`*^9}, {
  3.628309613098043*^9, 3.628309622544286*^9}, {3.628310395644142*^9, 
  3.6283104033652153`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"mstEdgePoolSize", "[", "edgePool_", "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "edgePool"}], "]"}], 
     "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.62830970392414*^9, 3.6283097439011993`*^9}, {
  3.628476859227293*^9, 3.628476862295904*^9}}],

Cell["MST:", "Text",
 CellChangeTimes->{{3.62822617227632*^9, 3.6282261999081173`*^9}, {
  3.628309613098043*^9, 3.628309622544286*^9}, {3.628310395644142*^9, 
  3.6283104033652153`*^9}, {3.628369473483448*^9, 3.628369476980885*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"MST", "[", "edgePool_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"first", ",", "size", ",", "e"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"first", "=", 
       RowBox[{"mstCreateFirst", "[", "edgePool", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{"mstEdgePoolSize", "[", "edgePool", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NestWhile", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mstAddTest", "[", 
          RowBox[{"#", ",", "edgePool", ",", "size"}], "]"}], "&"}], ",", 
        "first", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"size", "-", "1"}]}], "&"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.628310014131921*^9, 3.628310236608017*^9}, {
  3.6283103860099*^9, 3.628310388471249*^9}, {3.628476865651623*^9, 
  3.628476868665695*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"MSTdmat", "[", "dm_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"edgePool", ",", "first", ",", "size", ",", "e"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"edgePool", "=", 
       RowBox[{"udEdgeTake", "[", "dm", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"first", "=", 
       RowBox[{"mstCreateFirst", "[", "edgePool", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{"mstEdgePoolSize", "[", "edgePool", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NestWhile", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mstAddTest", "[", 
          RowBox[{"#", ",", "edgePool", ",", "size"}], "]"}], "&"}], ",", 
        "first", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
          RowBox[{"size", "-", "1"}]}], "&"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.628369689305541*^9, 3.628369774684781*^9}, {
  3.628476871051834*^9, 3.6284768740255527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MSTBaseShift", "[", 
   RowBox[{"mstNode_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"mstNode", "+", 
   RowBox[{"{", 
    RowBox[{"s", ",", "s", ",", "0"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.628477941453517*^9, 3.628478005287944*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test(1)", "Section",
 CellChangeTimes->{{3.6283102925010443`*^9, 3.628310313981181*^9}, {
  3.628479163225309*^9, 3.628479164041319*^9}}],

Cell["list", "Text",
 CellChangeTimes->{{3.628225971386003*^9, 3.6282259770883217`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"li", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "9"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.628159755139393*^9, 3.628159794718109*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "9"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.628159796995309*^9, 3.628219127078155*^9, 
  3.628221852573024*^9, 3.6282219651135902`*^9, 3.628223528515903*^9, 
  3.628224429004717*^9, 3.628308954922543*^9, 3.6283104339065228`*^9, 
  3.628369514538392*^9}]
}, Open  ]],

Cell["distance matrix", "Text",
 CellChangeTimes->{{3.62822598063358*^9, 3.6282259901794243`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dm", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{"EuclideanDistance", ",", "li", ",", "li", ",", "1"}], "]"}], "//",
    "N"}]}]], "Input",
 CellChangeTimes->{{3.6281598038094797`*^9, 3.62815988741253*^9}, {
  3.628369900045903*^9, 3.628369901609434*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "2.8284271247461903`", ",", "2.23606797749979`", ",", 
     "3.605551275463989`", ",", "7.280109889280518`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.8284271247461903`", ",", "0.`", ",", "1.`", ",", "1.`", ",", "5.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23606797749979`", ",", "1.`", ",", "0.`", ",", "1.4142135623730951`", 
     ",", "5.0990195135927845`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.605551275463989`", ",", "1.`", ",", "1.4142135623730951`", ",", "0.`", 
     ",", "4.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "7.280109889280518`", ",", "5.`", ",", "5.0990195135927845`", ",", "4.`", 
     ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.628159817089081*^9, 3.628159888348876*^9}, 
   3.6282191275251093`*^9, 3.628221853146138*^9, 3.628221965490644*^9, 
   3.628223529066802*^9, 3.628224429283896*^9, 3.6283089598914623`*^9, 
   3.628310433972576*^9, 3.628369514931176*^9, 3.628369902152547*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.628369961896996*^9, 3.628369972329803*^9}}],

Cell[BoxData["\<\"/home/kamano/gitsrc/ClusteringAdequation\"\>"], "Output",
 CellChangeTimes->{{3.628369968905244*^9, 3.628369972713702*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<dm.tsv\>\"", ",", "dm"}], "]"}]], "Input",
 CellChangeTimes->{{3.6283699245040083`*^9, 3.628369942402529*^9}}],

Cell[BoxData["\<\"dm.tsv\"\>"], "Output",
 CellChangeTimes->{3.62836994347686*^9, 3.628370217909874*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"e", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sort", "[", "#2", "]"}], ",", "#1"}], "}"}], "&"}], 
            ",", "dm", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_"}], "}"}], ",", "_"}], "}"}], "/;", 
         RowBox[{"x", "\[NotEqual]", "y"}]}]}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "<", 
       RowBox[{"#2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.628159907659543*^9, 3.6281600358502483`*^9}, {
  3.628160077026795*^9, 3.628160200540883*^9}, {3.628160364947867*^9, 
  3.628160478796342*^9}, {3.6282194078151913`*^9, 3.628219408359481*^9}, {
  3.6283696106410103`*^9, 3.6283696137001553`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     SqrtBox["2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     SqrtBox["5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     SqrtBox["13"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     SqrtBox["26"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     SqrtBox["53"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.628160444768754*^9, 3.62816047966334*^9}, 
   3.6282191282124043`*^9, 3.628219409104188*^9, 3.628221853586504*^9, 
   3.62822196584953*^9, 3.6282235294583282`*^9, 3.628224429538842*^9, 
   3.6283089684155827`*^9, 3.628310434129492*^9, 3.628369515724329*^9}]
}, Open  ]],

Cell["edge uniq:", "Text",
 CellChangeTimes->{{3.628225998624545*^9, 3.6282260093843517`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e", "=", 
  RowBox[{"udEdgeTake", "[", "dm", "]"}]}]], "Input",
 CellChangeTimes->{{3.628226079048118*^9, 3.628226089053196*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     SqrtBox["2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     SqrtBox["5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     SqrtBox["13"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], ",", 
     SqrtBox["26"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     SqrtBox["53"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.628226090041161*^9, 3.628308977651388*^9, 
  3.628310434181696*^9, 3.628369515988968*^9}]
}, Open  ]],

Cell["MST :", "Text",
 CellChangeTimes->{{3.628310497840596*^9, 3.628310508003121*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MST", "[", "e", "]"}]], "Input",
 CellChangeTimes->{{3.6283104823161697`*^9, 3.628310484925664*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", 
       SqrtBox["5"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}], ",", "4"}], "}"}]}], "}"}], ",", 
   "7"}], "}"}]], "Output",
 CellChangeTimes->{3.6283104853278637`*^9, 3.628369519803565*^9, 
  3.62836990890585*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", "0"}], "}"}]}], "&"}], ",", 
   RowBox[{
    RowBox[{"MSTdmat", "[", "dm", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.628310240745408*^9, 3.6283102443357153`*^9}, {
  3.628369863033061*^9, 3.6283698670599747`*^9}, {3.628370043126431*^9, 
  3.628370080189906*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", "2.23606797749979`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", "4.`"}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.628310244840065*^9, 3.6283104342292223`*^9, 3.6283695161880093`*^9, 
   3.628369867802805*^9, 3.628369912751976*^9, {3.62837004424255*^9, 
   3.628370081120728*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test(2)", "Section",
 CellChangeTimes->{{3.6283102925010443`*^9, 3.628310313981181*^9}, {
  3.628479163225309*^9, 3.628479192375339*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dm", "[", "\"\<iris20\>\"", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<iris.20.2.dmat\>\"", ",", "\"\<Table\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.628479214148611*^9, 3.6284792802595387`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mstMMA", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"MSTdmat", "[", 
       RowBox[{"dm", "[", "\"\<iris20\>\"", "]"}], "]"}], "//", "MSTreform"}],
      "//", "Sort"}]}], ")"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.6284792830909243`*^9, 3.6284793735770683`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "5", "0.141421356237309`"},
    {"1", "8", "0.141421356237309`"},
    {"1", "18", "0"},
    {"2", "10", "0.1`"},
    {"2", "13", "0.100000000000001`"},
    {"3", "4", "0.14142135623731`"},
    {"4", "13", "0.223606797749979`"},
    {"5", "18", "0.141421356237309`"},
    {"5", "20", "0.223606797749979`"},
    {"6", "11", "0.2`"},
    {"6", "17", "0"},
    {"7", "12", "0.2`"},
    {"8", "12", "0.2`"},
    {"8", "18", "0.141421356237309`"},
    {"9", "14", "0.14142135623731`"},
    {"10", "13", "0.14142135623731`"},
    {"11", "17", "0.2`"},
    {"15", "16", "0.412310562561766`"},
    {"15", "19", "0.223606797749979`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.628479294342142*^9, {3.6284793255364933`*^9, 3.628479362620606*^9}, 
   3.628479690448554*^9, 3.628480547873743*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "&"}], ",", "mstMMA"}], "]"}], "//", 
  "Tr"}]], "Input",
 CellChangeTimes->{{3.628479651113234*^9, 3.628479705616911*^9}}],

Cell[BoxData["3.07308044947287`"], "Output",
 CellChangeTimes->{{3.628479674399008*^9, 3.6284797062325487`*^9}, 
   3.628480547920747*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mstC", "=", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MSTBaseShift", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
       RowBox[{"Import", "[", 
        RowBox[{"\"\<iris.20.2.MST\>\"", ",", "\"\<Table\>\""}], "]"}]}], 
      "]"}], "//", "Sort"}]}], ")"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.628479376448402*^9, 3.6284793894169903`*^9}, {
  3.628479420443371*^9, 3.628479464017357*^9}, {3.62847955360121*^9, 
  3.628479586774538*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "5", "0.141421`"},
    {"1", "8", "0.141421`"},
    {"1", "18", "0.`"},
    {"2", "13", "0.1`"},
    {"3", "4", "0.141421`"},
    {"3", "10", "0.223607`"},
    {"4", "9", "0.282843`"},
    {"5", "20", "0.223607`"},
    {"6", "11", "0.2`"},
    {"6", "17", "0.`"},
    {"6", "19", "0.316228`"},
    {"7", "3", "0.223607`"},
    {"8", "12", "0.2`"},
    {"9", "14", "0.141421`"},
    {"10", "2", "0.1`"},
    {"12", "7", "0.2`"},
    {"15", "16", "0.412311`"},
    {"19", "15", "0.223607`"},
    {"20", "6", "0.316228`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6284794393527718`*^9, {3.628479564052369*^9, 3.6284795875305557`*^9}, 
   3.628480547968152*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "&"}], ",", "mstC"}], "]"}], "//", 
  "Tr"}]], "Input",
 CellChangeTimes->{{3.628479717281659*^9, 3.6284797264410152`*^9}}],

Cell[BoxData["3.5877220000000003`"], "Output",
 CellChangeTimes->{{3.628479713246579*^9, 3.628479727020441*^9}, 
   3.628480548019959*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mstC2", "=", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MSTBaseShift", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", 
       RowBox[{"Import", "[", 
        RowBox[{"\"\<tmp\>\"", ",", "\"\<Table\>\""}], "]"}]}], "]"}], "//", 
     "Sort"}]}], ")"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.628479376448402*^9, 3.6284793894169903`*^9}, {
  3.628479420443371*^9, 3.628479464017357*^9}, {3.62847955360121*^9, 
  3.628479586774538*^9}, {3.62848056418012*^9, 3.628480570374675*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "18", "0.`"},
    {"2", "10", "0.1`"},
    {"3", "4", "0.141421`"},
    {"4", "9", "0.282843`"},
    {"4", "13", "0.223607`"},
    {"5", "20", "0.223607`"},
    {"8", "12", "0.2`"},
    {"9", "14", "0.141421`"},
    {"12", "3", "0.223607`"},
    {"12", "7", "0.2`"},
    {"13", "2", "0.1`"},
    {"15", "16", "0.412311`"},
    {"17", "6", "0.`"},
    {"17", "11", "0.2`"},
    {"17", "19", "0.316228`"},
    {"18", "5", "0.141421`"},
    {"18", "8", "0.141421`"},
    {"19", "15", "0.223607`"},
    {"20", "17", "0.316228`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.628480571605729*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "&"}], ",", "mstC2"}], "]"}], "//", 
  "Tr"}]], "Input",
 CellChangeTimes->{{3.628479717281659*^9, 3.6284797264410152`*^9}, 
   3.628480584967947*^9}],

Cell[BoxData["3.587722`"], "Output",
 CellChangeTimes->{3.628480585791256*^9}]
}, Open  ]],

Cell["\:540c\:3058\:8ddd\:96e2\:306e\:7570\:306a\:308b\:30a8\:30c3\:30b8\:304c\
\:3042\:3063\:305f\:5834\:5408\:3001\:3069\:308c\:3092\:5148\:306b\:63a1\:7528\
\:3059\:308b\:304b\:3067\:7d50\:679c\:304c\:7570\:306a\:308b\:3002", "Text",
 CellChangeTimes->{{3.628480008089472*^9, 3.628480031986554*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Performance", "Section",
 CellChangeTimes->{{3.6283102925010443`*^9, 3.628310313981181*^9}, {
  3.628370305587387*^9, 3.628370309620599*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rl", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", "]"}], ",", 
     RowBox[{"{", "150", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6283703286350107`*^9, 3.62837037434533*^9}, {
  3.6283704166238613`*^9, 3.628370417669594*^9}, {3.6283705394024553`*^9, 
  3.628370540101808*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rd", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"EuclideanDistance", ",", "rl", ",", "rl", ",", "1"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6281598038094797`*^9, 3.62815988741253*^9}, {
  3.628369900045903*^9, 3.628369901609434*^9}, {3.628370446014921*^9, 
  3.62837046407189*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"MSTdmat", "[", "rd", "]"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.628370469726116*^9, 3.628370488328562*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.34394700000000000272848410531878471375`5.557091439046266", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.628370489512784*^9, 3.628370552398366*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 756},
WindowMargins->{{Automatic, 7}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (2014\:5e7412\
\:67084\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 206, 3, 92, "Title"],
Cell[CellGroupData[{
Cell[811, 29, 140, 2, 64, "Section"],
Cell[954, 33, 276, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[1255, 44, 246, 5, 28, "Input"],
Cell[1504, 51, 154, 2, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1707, 59, 145, 2, 64, "Section"],
Cell[1855, 63, 200, 4, 28, "Input"],
Cell[2058, 69, 182, 4, 30, "Text"],
Cell[2243, 75, 94, 1, 30, "Text"],
Cell[2340, 78, 1111, 32, 63, "Input"],
Cell[3454, 112, 102, 1, 30, "Text"],
Cell[3559, 115, 1449, 33, 131, "Input"],
Cell[5011, 150, 96, 1, 30, "Text"],
Cell[5110, 153, 2110, 54, 182, "Input"],
Cell[7223, 209, 153, 2, 30, "Text"],
Cell[7379, 213, 387, 11, 28, "Input"],
Cell[7769, 226, 197, 3, 30, "Text"],
Cell[7969, 231, 469, 13, 28, "Input"],
Cell[8441, 246, 233, 3, 30, "Text"],
Cell[8677, 251, 1158, 31, 114, "Input"],
Cell[9838, 284, 1238, 32, 131, "Input"],
Cell[11079, 318, 275, 7, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11391, 330, 143, 2, 64, "Section"],
Cell[11537, 334, 88, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[11650, 339, 448, 14, 28, "Input"],
Cell[12101, 355, 579, 16, 28, "Output"]
}, Open  ]],
Cell[12695, 374, 98, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[12818, 379, 290, 7, 28, "Input"],
Cell[13111, 388, 1066, 26, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14214, 419, 123, 2, 28, "Input"],
Cell[14340, 423, 141, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14518, 429, 164, 3, 28, "Input"],
Cell[14685, 434, 104, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14826, 440, 1216, 33, 46, "Input"],
Cell[16045, 475, 1573, 53, 61, "Output"]
}, Open  ]],
Cell[17633, 531, 94, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[17752, 536, 153, 3, 28, "Input"],
Cell[17908, 541, 1404, 51, 61, "Output"]
}, Open  ]],
Cell[19327, 595, 87, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[19439, 600, 124, 2, 28, "Input"],
Cell[19566, 604, 693, 24, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20296, 633, 542, 16, 28, "Input"],
Cell[20841, 651, 719, 24, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21609, 681, 143, 2, 64, "Section"],
Cell[21755, 685, 273, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[22053, 696, 335, 9, 28, "Input"],
Cell[22391, 707, 1278, 36, 346, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23706, 748, 257, 8, 28, "Input"],
Cell[23966, 758, 138, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24141, 765, 566, 15, 46, "Input"],
Cell[24710, 782, 1153, 36, 346, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25900, 823, 257, 8, 28, "Input"],
Cell[26160, 833, 138, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26335, 840, 601, 15, 28, "Input"],
Cell[26939, 857, 1080, 34, 346, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28056, 896, 284, 9, 28, "Input"],
Cell[28343, 907, 78, 1, 28, "Output"]
}, Open  ]],
Cell[28436, 911, 302, 3, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28775, 919, 147, 2, 64, "Section"],
Cell[28925, 923, 394, 10, 28, "Input"],
Cell[29322, 935, 331, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[29678, 947, 179, 4, 28, "Input"],
Cell[29860, 953, 203, 5, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
