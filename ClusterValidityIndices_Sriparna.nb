(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     29672,        882]
NotebookOptionsPosition[     25919,        748]
NotebookOutlinePosition[     26402,        767]
CellTagsIndexPosition[     26359,        764]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Some connectivity based cluster validity indices", "Title",
 CellChangeTimes->{{3.608454046637841*^9, 3.608454081613864*^9}}],

Cell[CellGroupData[{

Cell["\:6e96\:5099", "Section",
 CellChangeTimes->{{3.609058534994502*^9, 3.6090585451601887`*^9}, {
  3.610262271780499*^9, 3.6102622771150017`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/kouamano/gitsrc/ClusteringAdequation/test-data\>\"", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6090539953716784`*^9, 3.6090540147200403`*^9}, {
  3.609660175646903*^9, 3.609660178464222*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/amanokou/gitsrc/ClusteringAdequation/test-data\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6090539953716784`*^9, 3.6090540147200403`*^9}, {
  3.6096601679090557`*^9, 3.609660170534235*^9}}],

Cell[BoxData["\<\"/Users/amanokou/gitsrc/ClusteringAdequation/test-data\"\>"],\
 "Output",
 CellChangeTimes->{
  3.609660185520913*^9, {3.60966874998993*^9, 3.609668756299662*^9}, 
   3.61026228316997*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Program\:307e\:3068\:3081", "Section",
 CellChangeTimes->{{3.609058534994502*^9, 3.6090585451601887`*^9}}],

Cell["\<\
minindex\:3092\:3064\:304f\:308b\:3002
Input: dShortMat, Clustering\:306e\:7d50\:679c(\:30af\:30e9\:30b9\:30bfID\
\:306e\:30ea\:30b9\:30c8\:306e\:30ea\:30b9\:30c8).
output: \:30e1\:30f3\:30d0\:30fcID.\
\>", "Text",
 CellChangeTimes->{{3.6084541820845623`*^9, 3.608454329939084*^9}, {
  3.608455473531831*^9, 3.608455490260921*^9}}],

Cell["\<\
\:6700\:7d42\:7684\:306b\:3001z[k] = x[k,minindex]; z: medoid of cluster k, \
x: minindex-th member of cluster k\:3001\:3092\:6c42\:3081\:308b\:3002\
\>", "Text",
 CellChangeTimes->{{3.6084586093028307`*^9, 3.608458744249281*^9}}],

Cell["\:8ddd\:96e2\:884c\:5217\:304b\:3089\:7279\:5b9a\:306e\:30af\:30e9\:30b9\
\:30bf\:306b\:95a2\:3059\:308b\:90e8\:5206\:8ddd\:96e2\:884c\:5217\:3092\:629c\
\:304d\:51fa\:3059\:3002", "Text",
 CellChangeTimes->{{3.609058575911153*^9, 3.609058595814891*^9}, 
   3.609058854575791*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subDMat", "[", 
   RowBox[{"dmat_", ",", "members_"}], "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"dmat", "[", 
      RowBox[{"[", "members", "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "members", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609056678594493*^9, 3.609056700384342*^9}, {
  3.60905676006923*^9, 3.609056765362728*^9}, {3.609056832760825*^9, 
  3.609056855182769*^9}}],

Cell["\:90e8\:5206\:8ddd\:96e2\:884c\:5217\:3092\:3082\:3068\:306b\:7279\:5b9a\
\:306e\:30af\:30e9\:30b9\:30bf\:306eargmin\:3092\:6c42\:3081\:308b\:3002", \
"Text",
 CellChangeTimes->{
  3.609058627689025*^9, {3.60905866170156*^9, 3.6090587224749527`*^9}, {
   3.609058818897526*^9, 3.609058837351091*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"argMinDMat", "[", "dMat_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sumList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sumList", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Tr", "[", "#", "]"}], "&"}], ",", "dMat"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"sumList", ",", 
        RowBox[{"Min", "[", "sumList", "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.609056304994347*^9, 3.609056530187052*^9}}],

Cell["\<\
\:8ddd\:96e2\:884c\:5217\:3068\:30af\:30e9\:30b9\:30bf\:30ea\:30f3\:30b0\:7d50\
\:679c\:304b\:3089\:5404\:30af\:30e9\:30b9\:30bf\:306emedoid\:3092\:3082\:3068\
\:3081\:308b\:3002\
\>", "Text",
 CellChangeTimes->{{3.609058780134366*^9, 3.609058815201708*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findMedoidsParCL", "[", 
   RowBox[{"dmat_", ",", "clusterResult_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"argMinDMat", "[", 
      RowBox[{"subDMat", "[", 
       RowBox[{"dmat", ",", "#"}], "]"}], "]"}], "&"}], ",", 
    "clusterResult"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609057466853734*^9, 3.6090575207806053`*^9}, {
  3.609057674007146*^9, 3.609057764648025*^9}, {3.6090578275073643`*^9, 
  3.60905783014426*^9}}],

Cell["\:5404\:30af\:30e9\:30b9\:30bf\:306emedoid\:756a\:53f7\:304b\:3089\:3082\
\:3068\:306e\:30b5\:30f3\:30d7\:30eb\:756a\:53f7\:3092\:6c42\:3081\:308b\:3002\
", "Text",
 CellChangeTimes->{{3.609058867427833*^9, 3.6090589056302032`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"orgIndexFromMedoidParCL", "[", 
   RowBox[{"medoids_", ",", "clusterResult_"}], "]"}], ":=", 
  RowBox[{"Inner", "[", 
   RowBox[{"Part", ",", "clusterResult", ",", "medoids", ",", "List"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.609058284339569*^9, 3.6090584189148397`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sample", "Section",
 CellChangeTimes->{{3.606034047507456*^9, 3.6060340797165213`*^9}, {
  3.609053084765521*^9, 3.609053104466848*^9}, {3.609053522827886*^9, 
  3.609053528282591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sample", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.609053452988316*^9, 3.609053503577524*^9}, {
  3.609054032501409*^9, 3.6090540393877163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.609053505553536*^9, 3.609054040410921*^9, 
  3.6096638213373327`*^9, 3.609668730183543*^9, 3.609668771849215*^9, 
  3.610262326625971*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FindClusters Examples", "Section",
 CellChangeTimes->{{3.606034047507456*^9, 3.6060340797165213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fc", "=", 
  RowBox[{"FindClusters", "[", 
   RowBox[{
    RowBox[{"sample", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "sample", "]"}], "]"}]}], ",", "3", ",", 
    RowBox[{"Method", "\[Rule]", "\"\<Agglomerate\>\""}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.606033793015903*^9, 3.60603383291689*^9}, {
  3.6060340218805227`*^9, 3.606034026947016*^9}, {3.609053554501706*^9, 
  3.609053586885703*^9}, {3.609056788739505*^9, 3.609056804396954*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.60603383365833*^9, 3.6060340278139544`*^9, {3.609053572420772*^9, 
   3.609053587743553*^9}, 3.609054044581629*^9, {3.609056790475038*^9, 
   3.6090568049956627`*^9}, 3.609663825135777*^9, 3.6096687347618856`*^9, 
   3.6096687766568336`*^9, 3.610262331654888*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DistanceMatrix", "Section",
 CellChangeTimes->{{3.609053643940978*^9, 3.609053662195283*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleDmat", "=", 
  RowBox[{"Outer", "[", 
   RowBox[{"EuclideanDistance", ",", 
    RowBox[{"sample", "//", "N"}], ",", "sample", ",", "1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6090536736254387`*^9, 3.6090537092594967`*^9}, {
  3.609053844719688*^9, 3.609053902141259*^9}, {3.609053934821576*^9, 
  3.609053953519042*^9}, {3.609054158820077*^9, 3.609054164549304*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "2.23606797749979`", ",", "4.123105625617661`", ",", 
     "5.385164807134504`", ",", "3.741657386773941`", ",", 
     "2.23606797749979`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23606797749979`", ",", "0.`", ",", "2.449489742783178`", ",", 
     "4.47213595499958`", ",", "1.7320508075688772`", ",", 
     "3.741657386773941`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.123105625617661`", ",", "2.449489742783178`", ",", "0.`", ",", 
     "2.449489742783178`", ",", "1.`", ",", "4.47213595499958`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5.385164807134504`", ",", "4.47213595499958`", ",", "2.449489742783178`",
      ",", "0.`", ",", "3.3166247903554003`", ",", "4.69041575982343`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.741657386773941`", ",", "1.7320508075688772`", ",", "1.`", ",", 
     "3.3166247903554003`", ",", "0.`", ",", "4.58257569495584`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23606797749979`", ",", "3.741657386773941`", ",", "4.47213595499958`", 
     ",", "4.69041575982343`", ",", "4.58257569495584`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.609053710096299*^9, {3.609053855931912*^9, 3.609053902354375*^9}, {
   3.609053935902514*^9, 3.609053954290227*^9}, 3.609054058573904*^9, 
   3.609054165925712*^9, 3.609663829526579*^9, 3.609668738913149*^9, 
   3.609668779302476*^9, 3.6102623398934727`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<sample.dmat\>\"", ",", "sampleDmat", ",", "\"\<TSV\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6090541407301683`*^9, 3.609054190943975*^9}}],

Cell[BoxData["\<\"sample.dmat\"\>"], "Output",
 CellChangeTimes->{{3.609054183975709*^9, 3.609054191878911*^9}, 
   3.609663829749354*^9, 3.609668739149164*^9, 3.609668779440115*^9}]
}, Open  ]],

Cell["RNG_d df = sample.dmat size = 6 > sample.RNGd", "Text",
 CellChangeTimes->{{3.609665407943199*^9, 3.609665413769041*^9}}],

Cell["\<\
mk_d _short _mat loop = 6 dsize = 6 ef = sample.RNGd > sample.dsmat\
\>", "Text",
 CellChangeTimes->{{3.609665499238667*^9, 3.609665502653715*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleDSmat", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"\"\<sample.dsmat\>\"", ",", "\"\<Table\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609665571575436*^9, 3.609665610928726*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "2.236068`", ",", "2.236068`", ",", "2.44949`", ",", 
     "2.236068`", ",", "2.236068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "1.732051`", ",", "1.732051`", ",", "2.44949`", ",", 
     "1.732051`", ",", "2.236068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "1.732051`", ",", "1.`", ",", "2.44949`", ",", "1.`", 
     ",", "2.236068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.44949`", ",", "2.44949`", ",", "2.44949`", ",", "2.44949`", ",", 
     "2.44949`", ",", "2.44949`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "1.732051`", ",", "1.`", ",", "2.44949`", ",", "1.`", 
     ",", "2.236068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "2.236068`", ",", "2.236068`", ",", "2.44949`", ",", 
     "2.236068`", ",", "2.236068`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.609665587292746*^9, 3.60966561545879*^9}, 
   3.609668739229197*^9, 3.609668779475958*^9, 3.610262423097514*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleDSmatZeroself", "=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{"sampleDSmat", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "x_"}], "}"}], "\[Rule]", "0"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.6096661118269567`*^9, 3.609666118107872*^9}, {
  3.609666204347472*^9, 3.609666252138411*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "2.236068`", ",", "2.236068`", ",", "2.44949`", ",", 
     "2.236068`", ",", "2.236068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "0", ",", "1.732051`", ",", "2.44949`", ",", 
     "1.732051`", ",", "2.236068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "1.732051`", ",", "0", ",", "2.44949`", ",", "1.`", ",",
      "2.236068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.44949`", ",", "2.44949`", ",", "2.44949`", ",", "0", ",", "2.44949`", 
     ",", "2.44949`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "1.732051`", ",", "1.`", ",", "2.44949`", ",", "0", ",",
      "2.236068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.236068`", ",", "2.236068`", ",", "2.236068`", ",", "2.44949`", ",", 
     "2.236068`", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.609666237712668*^9, 3.6096662532037497`*^9}, 
   3.609668739267376*^9, 3.6096687795087*^9, 3.610262426807745*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"subDMat", "[", 
  RowBox[{"sampleDmat", ",", 
   RowBox[{"fc", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6090567726322947`*^9, 3.609056781799241*^9}, {
  3.609056817464559*^9, 3.6090568209005213`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "2.449489742783178`", ",", "1.7320508075688772`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.449489742783178`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.7320508075688772`", ",", "1.`", ",", "0.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.609056821334499*^9, 3.6090568580832577`*^9, 
  3.609663829858388*^9, 3.609668739367568*^9, 3.609668779625605*^9, 
  3.610262447023637*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"argMinDMat", "[", 
  RowBox[{"subDMat", "[", 
   RowBox[{"sampleDmat", ",", 
    RowBox[{"fc", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.609056364086227*^9, 3.6090563752858458`*^9}, {
  3.609056976287757*^9, 3.609057013811372*^9}}],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{{3.609056376161211*^9, 3.609056385067355*^9}, {
   3.609056501202826*^9, 3.609056533583609*^9}, {3.609056995848481*^9, 
   3.609057014249961*^9}, 3.609663829909284*^9, 3.60966873941805*^9, 
   3.609668779660562*^9, 3.610262448959258*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"medoidsID", "=", 
  RowBox[{"findMedoidsParCL", "[", 
   RowBox[{"sampleDmat", ",", "fc"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609057768110178*^9, 3.609057777912076*^9}, {
  3.6090578358195744`*^9, 3.609057837374674*^9}, {3.609058434213464*^9, 
  3.609058440823859*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.609057778583959*^9, 3.609057839167386*^9, 
  3.609058442614964*^9, 3.6096638299917927`*^9, 3.6096687395013437`*^9, 
  3.609668779742193*^9, 3.610262450869939*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleMedoids", "=", 
  RowBox[{
   RowBox[{"orgIndexFromMedoidParCL", "[", 
    RowBox[{"medoidsID", ",", "fc"}], "]"}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.609058423111825*^9, 3.609058454879383*^9}, {
  3.6096664690281057`*^9, 3.609666506521204*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "5", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.60905845108144*^9, 3.609058455800338*^9}, 
   3.609663830077571*^9, {3.609666480208473*^9, 3.609666507733487*^9}, 
   3.609668739586295*^9, 3.609668779809379*^9, 3.610262454576256*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["cDB", "Section",
 CellChangeTimes->{{3.609059120501997*^9, 3.6090591338673077`*^9}}],

Cell["\<\
cDB = Sum(R[i],{i,1,K}) / K   ; K:\:30af\:30e9\:30b9\:30bf\:6570
R[i] = Max((S[i]+S[j])/d[i,j])[{j,j\[NotEqual]i}]   ; i:\:30af\:30e9\:30b9\
\:30bfi, d[i,j]: \:30e6\:30fc\:30af\:30ea\:30c3\:30c9\:8ddd\:96e2\:884c\:5217
S[i] = Sum(dshort(x,z[i]),{x,x\[Element]C[i]}) / n[i]   ; z[i]:medoid of \
cluster i, n[i]:number of cluster points.\
\>", "Text",
 CellChangeTimes->{{3.6096609700019407`*^9, 3.60966102536547*^9}, {
  3.6096611398864202`*^9, 3.6096611555196867`*^9}, {3.609661710755906*^9, 
  3.6096617328694067`*^9}, {3.609661770783942*^9, 3.609661796599153*^9}, {
  3.609661838952344*^9, 3.60966190511904*^9}, {3.609662178369152*^9, 
  3.609662321372572*^9}, {3.609662426768025*^9, 3.60966244283663*^9}, {
  3.609662506030554*^9, 3.609662550571171*^9}, {3.609667214656312*^9, 
  3.609667249101758*^9}, {3.6096673039637337`*^9, 3.609667306856783*^9}, {
  3.609668117605084*^9, 3.609668123370373*^9}, {3.609668845151505*^9, 
  3.609668878852892*^9}}],

Cell[CellGroupData[{

Cell["Program", "Subsection",
 CellChangeTimes->{{3.609059120501997*^9, 3.6090591338673077`*^9}, {
  3.610262484193166*^9, 3.610262501620927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"dshortMatZeroself_", ",", "clMembers_", ",", "medoidIndex_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{"dshortMatZeroself", "[", 
     RowBox[{"[", 
      RowBox[{"medoidIndex", ",", "clMembers"}], "]"}], "]"}], "]"}], "/", 
   RowBox[{"Length", "[", "clMembers", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6096633926485453`*^9, 3.609663420491194*^9}, {
  3.6096634741543293`*^9, 3.609663489420961*^9}, {3.609663548332324*^9, 
  3.60966356614898*^9}, {3.60966360006035*^9, 3.609663602332294*^9}, {
  3.6096637260665693`*^9, 3.609663758154724*^9}, {3.609665652187275*^9, 
  3.609665660055718*^9}, {3.609665757808198*^9, 3.609665758220832*^9}, {
  3.6096658520680723`*^9, 3.609665853512081*^9}, {3.609666065769052*^9, 
  3.609666086111046*^9}, {3.6096663243647738`*^9, 3.6096663338670588`*^9}, {
  3.609666742414917*^9, 3.609666757474497*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"r", "[", 
   RowBox[{
   "edMat_", ",", "dshortMatZeroself_", ",", "cls_", ",", "medoids_", ",", 
    "i_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "js", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"js", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "cls", "]"}], "]"}], ",", 
        RowBox[{"{", "i", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Max", "[", "  ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"dshortMatZeroself", ",", 
              RowBox[{"cls", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"medoids", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "+", 
            RowBox[{"s", "[", 
             RowBox[{"dshortMatZeroself", ",", 
              RowBox[{"cls", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"medoids", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "]"}]}], ")"}], "/", 
          RowBox[{"edMat", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "#"}], "]"}], "]"}]}], "&"}], ",", "js"}], 
       "]"}], "  ", "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6096670336790857`*^9, 3.6096670952673073`*^9}, {
   3.609667369265757*^9, 3.609667427170394*^9}, {3.609667465690029*^9, 
   3.609667486456049*^9}, {3.6096675434058533`*^9, 3.609667672242621*^9}, {
   3.609667705697123*^9, 3.609667758881617*^9}, {3.6096682152155943`*^9, 
   3.609668244830831*^9}, {3.609668301016952*^9, 3.609668347943172*^9}, {
   3.609668469821803*^9, 3.609668507677248*^9}, {3.60966858156385*^9, 
   3.6096686097620573`*^9}, 3.609669002587385*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cDB", "[", 
   RowBox[{
   "edMat_", ",", "dshortMatZeroself_", ",", "cls_", ",", "medoids_"}], "]"}],
   ":=", 
  RowBox[{"Tr", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "edMat", ",", "dshortMatZeroself", ",", "cls", ",", "medoids", ",", 
       "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "cls", "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.609667773866969*^9, 3.609667775612274*^9}, {
  3.609667810878871*^9, 3.609667810954999*^9}, {3.609667854664585*^9, 
  3.6096679592413692`*^9}, {3.609668521689289*^9, 3.6096685247605457`*^9}, {
  3.609668692631259*^9, 3.6096686970315733`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.609059120501997*^9, 3.6090591338673077`*^9}, {
  3.610262484193166*^9, 3.6102625231243*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cDB", "[", 
  RowBox[{
  "sampleDmat", ",", "sampleDSmatZeroself", ",", "fc", ",", "sampleMedoids"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.6096679297652817`*^9, 3.609667940615513*^9}, {
  3.60966864670347*^9, 3.609668650925036*^9}}],

Cell[BoxData["2.1863252939985993`"], "Output",
 CellChangeTimes->{{3.609667941516108*^9, 3.6096679617964*^9}, 
   3.609668254946026*^9, 3.609668353342196*^9, {3.60966865239826*^9, 
   3.609668703814863*^9}, 3.609668801606373*^9, 3.610262537662189*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r", "[", 
  RowBox[{
  "sampleDmat", ",", "sampleDSmatZeroself", ",", "fc", ",", "sampleMedoids", 
   ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.609667492500947*^9, 3.609667538289896*^9}, {
  3.609667689914255*^9, 3.6096676911249857`*^9}, {3.6096688120038033`*^9, 
  3.609668814892222*^9}}],

Cell[BoxData["0.9072701219642851`"], "Output",
 CellChangeTimes->{
  3.6096675455306*^9, {3.609667675301941*^9, 3.609667691947988*^9}, {
   3.6096677363200293`*^9, 3.6096677618888493`*^9}, 3.6096682064788713`*^9, 
   3.6096688159411573`*^9, 3.61026253776318*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleDSmat", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60966566547438*^9, 3.6096658172285433`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.236068`", ",", "2.236068`", ",", "2.236068`", ",", "2.44949`", ",", 
   "2.236068`", ",", "2.236068`"}], "}"}]], "Output",
 CellChangeTimes->{3.609665817911686*^9, 3.609668819504092*^9, 
  3.610262537798501*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleDSmat", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4", ",", "6"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60966566547438*^9, 3.609665830694653*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.236068`", ",", "2.44949`", ",", "2.236068`"}], "}"}]], "Output",
 CellChangeTimes->{{3.609665690240196*^9, 3.609665831080701*^9}, 
   3.609668821705641*^9, 3.6102625378494177`*^9}]
}, Open  ]],

Cell["s : i = 2", "Text",
 CellChangeTimes->{{3.609666776513919*^9, 3.609666793481648*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "[", 
  RowBox[{"sampleDSmatZeroself", ",", 
   RowBox[{"fc", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"sampleMedoids", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.609666341509926*^9, 3.60966634192317*^9}, {
  3.609666396689062*^9, 3.609666439496132*^9}, {3.60966651819553*^9, 
  3.609666523073662*^9}, {3.609667171801498*^9, 3.609667175061735*^9}}],

Cell[BoxData["1.118034`"], "Output",
 CellChangeTimes->{3.6096671757905197`*^9, 3.609668826221158*^9, 
  3.610262537899034*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "[", 
  RowBox[{"sampleDSmatZeroself", ",", 
   RowBox[{"fc", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", 
   RowBox[{"sampleMedoids", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.609666341509926*^9, 3.60966634192317*^9}, {
  3.609666396689062*^9, 3.609666439496132*^9}, {3.60966651819553*^9, 
  3.609666523073662*^9}}],

Cell[BoxData["0.9106836666666667`"], "Output",
 CellChangeTimes->{3.609666397554908*^9, 3.609666523724321*^9, 
  3.609667163805952*^9, 3.609668828556725*^9, 3.610262537948051*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "[", 
  RowBox[{"sampleDSmatZeroself", ",", 
   RowBox[{"fc", "[", 
    RowBox[{"[", "3", "]"}], "]"}], ",", 
   RowBox[{"sampleMedoids", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.609666341509926*^9, 3.60966634192317*^9}, {
  3.609666396689062*^9, 3.609666439496132*^9}, {3.60966651819553*^9, 
  3.609666523073662*^9}, {3.609667171801498*^9, 3.609667190930813*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.609667191547963*^9, 3.609668831296462*^9, 
  3.6102625379986067`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["cDunn", "Section",
 CellChangeTimes->{{3.6096680895410337`*^9, 3.6096680948901043`*^9}}]
}, Open  ]]
},
WindowSize->{861, 669},
WindowMargins->{{-1, Automatic}, {Automatic, 0}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (2011\:5e744\
\:67085\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 131, 1, 185, "Title"],
Cell[CellGroupData[{
Cell[735, 27, 150, 2, 103, "Section"],
Cell[888, 31, 279, 7, 64, "Input"],
Cell[CellGroupData[{
Cell[1192, 42, 252, 5, 64, "Input"],
Cell[1447, 49, 205, 4, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1701, 59, 112, 1, 102, "Section"],
Cell[1816, 62, 341, 7, 86, "Text"],
Cell[2160, 71, 240, 4, 65, "Text"],
Cell[2403, 77, 286, 4, 41, "Text"],
Cell[2692, 83, 483, 12, 65, "Input"],
Cell[3178, 97, 306, 5, 41, "Text"],
Cell[3487, 104, 679, 19, 111, "Input"],
Cell[4169, 125, 268, 5, 41, "Text"],
Cell[4440, 132, 501, 13, 65, "Input"],
Cell[4944, 147, 238, 3, 41, "Text"],
Cell[5185, 152, 316, 7, 65, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5538, 164, 191, 3, 100, "Section"],
Cell[CellGroupData[{
Cell[5754, 171, 766, 18, 179, "Input"],
Cell[6523, 191, 627, 17, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7199, 214, 108, 1, 100, "Section"],
Cell[CellGroupData[{
Cell[7332, 219, 503, 11, 64, "Input"],
Cell[7838, 232, 503, 12, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8390, 250, 99, 1, 100, "Section"],
Cell[CellGroupData[{
Cell[8514, 255, 404, 8, 40, "Input"],
Cell[8921, 265, 1506, 36, 156, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10464, 306, 200, 4, 40, "Input"],
Cell[10667, 312, 182, 2, 40, "Output"]
}, Open  ]],
Cell[10864, 317, 127, 1, 39, "Text"],
Cell[10994, 320, 157, 3, 39, "Text"],
Cell[CellGroupData[{
Cell[11176, 327, 213, 4, 40, "Input"],
Cell[11392, 333, 1101, 28, 156, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12530, 366, 344, 9, 42, "Input"],
Cell[12877, 377, 1067, 28, 156, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13981, 410, 266, 6, 40, "Input"],
Cell[14250, 418, 508, 13, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14795, 436, 304, 7, 40, "Input"],
Cell[15102, 445, 307, 5, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15446, 455, 300, 6, 40, "Input"],
Cell[15749, 463, 339, 8, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16125, 476, 293, 6, 40, "Input"],
Cell[16421, 484, 290, 5, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16760, 495, 90, 1, 100, "Section"],
Cell[16853, 498, 962, 15, 109, "Text"],
Cell[CellGroupData[{
Cell[17840, 517, 146, 2, 51, "Subsection"],
Cell[17989, 521, 922, 18, 88, "Input"],
Cell[18914, 541, 1920, 46, 226, "Input"],
Cell[20837, 589, 743, 20, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21617, 614, 145, 2, 51, "Subsection"],
Cell[CellGroupData[{
Cell[21787, 620, 261, 6, 40, "Input"],
Cell[22051, 628, 251, 3, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22339, 636, 322, 7, 40, "Input"],
Cell[22664, 645, 262, 4, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22963, 654, 154, 3, 40, "Input"],
Cell[23120, 659, 256, 6, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23413, 670, 237, 6, 40, "Input"],
Cell[23653, 678, 222, 4, 40, "Output"]
}, Open  ]],
Cell[23890, 685, 91, 1, 39, "Text"],
Cell[CellGroupData[{
Cell[24006, 690, 434, 9, 40, "Input"],
Cell[24443, 701, 127, 2, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24607, 708, 388, 9, 40, "Input"],
Cell[24998, 719, 179, 2, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25214, 726, 434, 9, 40, "Input"],
Cell[25651, 737, 119, 2, 40, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[25809, 744, 94, 1, 100, "Section"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
