(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45275,       1278]
NotebookOptionsPosition[     40447,       1112]
NotebookOutlinePosition[     41308,       1143]
CellTagsIndexPosition[     41180,       1137]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[" Amano-Wada clustering validity indices", "Title",
 CellChangeTimes->{{3.620376702168819*^9, 3.6203767374970922`*^9}}],

Cell[CellGroupData[{

Cell["\:6e96\:5099", "Section",
 CellChangeTimes->{{3.609058534994502*^9, 3.6090585451601887`*^9}, {
  3.610262271780499*^9, 3.6102622771150017`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/kouamano/gitsrc/ClusteringAdequation/test-data\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6090539953716784`*^9, 3.6090540147200403`*^9}, {
  3.609660175646903*^9, 3.609660178464222*^9}, {3.610861499017685*^9, 
  3.610861501894782*^9}, {3.620376794670936*^9, 3.6203767973417892`*^9}, {
  3.6204331147782*^9, 3.6204331190629673`*^9}, {3.621741406199638*^9, 
  3.6217414093107357`*^9}}],

Cell[BoxData["\<\"/Users/kouamano/gitsrc/ClusteringAdequation/test-data\"\>"],\
 "Output",
 CellChangeTimes->{3.6217414102622013`*^9, 3.62235225588195*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/amanokou/gitsrc/ClusteringAdequation/test-data\>\"", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6090539953716784`*^9, 3.6090540147200403`*^9}, {
  3.6096601679090557`*^9, 3.609660170534235*^9}, {3.614464793646913*^9, 
  3.614464797086253*^9}, {3.620433124038519*^9, 3.620433126598084*^9}, {
  3.620706304313096*^9, 3.6207063070374804`*^9}, {3.621679466565256*^9, 
  3.621679469744594*^9}, {3.621741393646371*^9, 3.621741402643713*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "SetDirectory", "[", 
   "\"\</home/kamano/gitsrc/ClusteringAdequation/test-data\>\"", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6090539953716784`*^9, 3.6090540147200403`*^9}, {
  3.6096601679090557`*^9, 3.609660170534235*^9}, {3.614461158477817*^9, 
  3.614461167742083*^9}, {3.617946347522086*^9, 3.617946353155634*^9}, {
  3.617956900286704*^9, 3.617956929585043*^9}, {3.620376788873835*^9, 
  3.6203767877031918`*^9}, {3.620706311295027*^9, 3.6207063140266447`*^9}, {
  3.621679460012679*^9, 3.621679462785399*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Get", "[", 
   "\"\</home/kamano/gitsrc/MATH_SCRIPT/SCRIPTS/ConnectiveClass.txt\>\"", 
   "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.61795693883834*^9, 3.617956959530879*^9}, {
  3.618093482154457*^9, 3.618093485413845*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Get", "[", 
   "\"\</home/kamano/gitsrc/MATH_SCRIPT/SCRIPTS/Cluster+Distance_Operations.\
txt\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6207062716194363`*^9, 3.620706288511456*^9}, {
  3.621679505913815*^9, 3.621679509484864*^9}}],

Cell[BoxData[
 RowBox[{"Get", "[", 
  "\"\</Users/kouamano/gitsrc/MATH_SCRIPT/SCRIPTS/Cluster+Distance_Operations.\
txt\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6216795333880787`*^9, 3.621679548395947*^9}, {
  3.621741432785185*^9, 3.621741437336574*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Get", "[", 
   "\"\</Users/amanokou/gitsrc/MATH_SCRIPT/SCRIPTS/Cluster+Distance_\
Operations.txt\>\"", "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6216795333880787`*^9, 3.621679548395947*^9}, {
  3.62174142434347*^9, 3.621741427384591*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:57fa\:672cProgram\:307e\:3068\:3081", "Section",
 CellChangeTimes->{{3.609058534994502*^9, 3.6090585451601887`*^9}, 
   3.610861724725685*^9}],

Cell["\:30d5\:30a1\:30a4\:30eb \
\[OpenCurlyDoubleQuote]Cluster+Distance_Operations.txt\[CloseCurlyDoubleQuote]\
 \:306b\:79fb\:884c\:3002", "Text",
 CellChangeTimes->{{3.620706370938202*^9, 3.620706393163041*^9}}],

Cell["\:8ddd\:96e2\:884c\:5217\:304b\:3089\:7279\:5b9a\:306e\:30af\:30e9\:30b9\
\:30bf\:306b\:95a2\:3059\:308b\:90e8\:5206\:8ddd\:96e2\:884c\:5217\:3092\:629c\
\:304d\:51fa\:3059\:3002", "Text",
 CellChangeTimes->{{3.609058575911153*^9, 3.609058595814891*^9}, 
   3.609058854575791*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "subDMat"}]], "Input",
 CellChangeTimes->{{3.6216796357030983`*^9, 3.6216796418444443`*^9}}],

Cell[CellGroupData[{

Cell["Global`subDMat", "Print", "PrintUsage",
 CellChangeTimes->{3.621679765593523*^9},
 CellTags->"Info3621712165-5101928"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"subDMat", "[", 
          RowBox[{"dmat_", ",", "members_"}], "]"}], ":=", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
            "dmat", "\[LeftDoubleBracket]", "members", 
             "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", 
           "members", "\[RightDoubleBracket]"}], "]"}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`subDMat],
  Editable->False]], "Print",
 CellChangeTimes->{3.6216797656620407`*^9},
 CellTags->"Info3621712165-5101928"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"subDMat", "[", 
    RowBox[{"dmat_", ",", "members_"}], "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"dmat", "[", 
       RowBox[{"[", "members", "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "members", "]"}], "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.609056678594493*^9, 3.609056700384342*^9}, {
  3.60905676006923*^9, 3.609056765362728*^9}, {3.609056832760825*^9, 
  3.609056855182769*^9}, {3.620706330234762*^9, 3.620706333066091*^9}}],

Cell["\:90e8\:5206\:8ddd\:96e2\:884c\:5217\:3092\:3082\:3068\:306b\:7279\:5b9a\
\:306e\:30af\:30e9\:30b9\:30bf\:306eargmin\:3092\:6c42\:3081\:308b(minindex)\
\:3002", "Text",
 CellChangeTimes->{
  3.609058627689025*^9, {3.60905866170156*^9, 3.6090587224749527`*^9}, {
   3.609058818897526*^9, 3.609058837351091*^9}, {3.614467269090719*^9, 
   3.614467273866247*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "argMinDMat"}]], "Input",
 CellChangeTimes->{{3.62167978929746*^9, 3.6216798010009108`*^9}}],

Cell[CellGroupData[{

Cell["Global`argMinDMat", "Print", "PrintUsage",
 CellChangeTimes->{3.6216798017577744`*^9},
 CellTags->"Info3621712201-5101928"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"argMinDMat", "[", "dmat_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "sumList", "}"}], ",", 
           RowBox[{
            RowBox[{"sumList", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Tr", "[", "#1", "]"}], "&"}], ")"}], "/@", 
              "dmat"}]}], ";", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"sumList", ",", 
               RowBox[{"Min", "[", "sumList", "]"}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
          "]"}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`argMinDMat],
  Editable->False]], "Print",
 CellChangeTimes->{3.621679801827607*^9},
 CellTags->"Info3621712201-5101928"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"argMinDMat", "[", "dmat_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "sumList", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sumList", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Tr", "[", "#", "]"}], "&"}], ",", "dmat"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"sumList", ",", 
         RowBox[{"Min", "[", "sumList", "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.609056304994347*^9, 3.609056530187052*^9}, {
  3.610875972857506*^9, 3.6108759778486767`*^9}, {3.6207063364714203`*^9, 
  3.6207063390458727`*^9}}],

Cell["\:8ddd\:96e2\:884c\:5217\:3068\:30af\:30e9\:30b9\:30bf\:30ea\:30f3\:30b0\
\:7d50\:679c\:304b\:3089\:5404\:30af\:30e9\:30b9\:30bf\:306emedoid\:3092\:3082\
\:3068\:3081\:308b\:3002", "Text",
 CellChangeTimes->{{3.609058780134366*^9, 3.609058815201708*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"findMedoidsParCL", "[", 
    RowBox[{"dmat_", ",", "clusterResult_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"argMinDMat", "[", 
       RowBox[{"subDMat", "[", 
        RowBox[{"dmat", ",", "#"}], "]"}], "]"}], "&"}], ",", 
     "clusterResult"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.609057466853734*^9, 3.6090575207806053`*^9}, {
  3.609057674007146*^9, 3.609057764648025*^9}, {3.6090578275073643`*^9, 
  3.60905783014426*^9}, {3.620706342107047*^9, 3.620706344856792*^9}}],

Cell["\:5404\:30af\:30e9\:30b9\:30bf\:306emedoid\:756a\:53f7\:304b\:3089\:3082\
\:3068\:306e\:30b5\:30f3\:30d7\:30eb\:756a\:53f7\:3092\:6c42\:3081\:308b\:3002\
", "Text",
 CellChangeTimes->{{3.609058867427833*^9, 3.6090589056302032`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"orgIndexFromMedoidParCL", "[", 
    RowBox[{"clusterResult_", ",", "medoids_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "fmedoids"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l", "=", 
       RowBox[{"Length", "[", "medoids", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"fmedoids", "=", 
       RowBox[{"Flatten", "[", "medoids", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"clusterResult", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"medoids", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "l"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6108776036575823`*^9, 3.6108776037305117`*^9}, {
  3.610877636024678*^9, 3.6108777357516747`*^9}, {3.6108777909007807`*^9, 
  3.610877846323398*^9}, {3.620706347589912*^9, 3.620706351626333*^9}}],

Cell["\:8ddd\:96e2\:884c\:5217\:304b\:3089\:5404\:30af\:30e9\:30b9\:30bf\:306e\
\:90e8\:5206\:8ddd\:96e2\:884c\:5217\:3092\:6c42\:3081\:308b\:3002", "Text",
 CellChangeTimes->{{3.609058867427833*^9, 3.6090589056302032`*^9}, {
  3.620434159707165*^9, 3.620434195395053*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"clDmat", "[", 
    RowBox[{"dmat_", ",", "cls_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"subDMat", "[", 
       RowBox[{"dmat", ",", "#"}], "]"}], "&"}], ",", "cls"}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.620434214310219*^9, 3.620434278964068*^9}, {
  3.620706353443008*^9, 3.620706355862165*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sample", "Section",
 CellChangeTimes->{{3.606034047507456*^9, 3.6060340797165213`*^9}, {
  3.609053084765521*^9, 3.609053104466848*^9}, {3.609053522827886*^9, 
  3.609053528282591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sample", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.609053452988316*^9, 3.609053503577524*^9}, {
  3.609054032501409*^9, 3.6090540393877163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.609053505553536*^9, 3.609054040410921*^9, 
  3.6096638213373327`*^9, 3.609668730183543*^9, 3.609668771849215*^9, 
  3.610262326625971*^9, 3.610861576612458*^9, 3.6108731820294333`*^9, 
  3.610877985707665*^9, 3.610878085841566*^9, 3.610878373023477*^9, 
  3.6108791352170258`*^9, 3.613895915147768*^9, 3.613898805021328*^9, 
  3.6144612386683483`*^9, 3.61446486194488*^9, 3.614467296721122*^9, 
  3.614471284293571*^9, 3.6144747672159433`*^9, 3.614475015934491*^9, 
  3.614475287912785*^9, 3.617946297079073*^9, 3.61794675316822*^9, 
  3.617946968471789*^9, 3.617947175716967*^9, 3.6180935688415327`*^9, 
  3.6180945465525846`*^9, 3.619832105618229*^9, 3.620086247217595*^9, 
  3.620376861093351*^9, 3.620378575432207*^9, 3.620378761220354*^9, 
  3.620433142564592*^9, 3.621546842550706*^9, 3.621679870860341*^9, 
  3.621741478325683*^9, 3.622352266598728*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{"\"\<sample.tsv\>\"", ",", "sample"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6215469856911507`*^9, 3.621547021481228*^9}, {
  3.621679865427991*^9, 3.621679884878478*^9}, {3.621741498267103*^9, 
  3.621741501544181*^9}, {3.6217415366295757`*^9, 3.62174154518431*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["FindClusters Examples", "Section",
 CellChangeTimes->{{3.606034047507456*^9, 3.6060340797165213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fc", "=", 
  RowBox[{"FindClusters", "[", 
   RowBox[{
    RowBox[{"sample", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "sample", "]"}], "]"}]}], ",", "3", ",", 
    RowBox[{"Method", "\[Rule]", "\"\<Agglomerate\>\""}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.606033793015903*^9, 3.60603383291689*^9}, {
  3.6060340218805227`*^9, 3.606034026947016*^9}, {3.609053554501706*^9, 
  3.609053586885703*^9}, {3.609056788739505*^9, 3.609056804396954*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.60603383365833*^9, 3.6060340278139544`*^9, {3.609053572420772*^9, 
   3.609053587743553*^9}, 3.609054044581629*^9, {3.609056790475038*^9, 
   3.6090568049956627`*^9}, 3.609663825135777*^9, 3.6096687347618856`*^9, 
   3.6096687766568336`*^9, 3.610262331654888*^9, 3.610861580007556*^9, 
   3.610873182081625*^9, 3.6108779857609158`*^9, 3.6108780858792152`*^9, 
   3.6108783730763807`*^9, 3.610879135271751*^9, 3.61389591865784*^9, 
   3.613898808711843*^9, 3.6144612456465893`*^9, 3.614464867282531*^9, 
   3.6144673041355247`*^9, 3.614471289299634*^9, 3.6144747677600403`*^9, 
   3.614475016139241*^9, 3.6144752881598063`*^9, 3.617946300769215*^9, 
   3.617946757458857*^9, 3.6179469714101753`*^9, 3.617947179365067*^9, 
   3.618093576079946*^9, 3.618094553463169*^9, 3.61983210963229*^9, 
   3.62008626486449*^9, 3.620376861114264*^9, 3.6203785820941753`*^9, 
   3.620378802673603*^9, 3.620433145126238*^9, 3.621546847398293*^9, 
   3.621679892191971*^9, 3.6217415068613462`*^9, 3.6223522703974123`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DistanceMatrix", "Section",
 CellChangeTimes->{{3.609053643940978*^9, 3.609053662195283*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleDmat", "=", 
  RowBox[{"Outer", "[", 
   RowBox[{"EuclideanDistance", ",", 
    RowBox[{"sample", "//", "N"}], ",", "sample", ",", "1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6090536736254387`*^9, 3.6090537092594967`*^9}, {
  3.609053844719688*^9, 3.609053902141259*^9}, {3.609053934821576*^9, 
  3.609053953519042*^9}, {3.609054158820077*^9, 3.609054164549304*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "2.23606797749979`", ",", "4.123105625617661`", ",", 
     "5.385164807134504`", ",", "3.741657386773941`", ",", 
     "2.23606797749979`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23606797749979`", ",", "0.`", ",", "2.449489742783178`", ",", 
     "4.47213595499958`", ",", "1.7320508075688772`", ",", 
     "3.741657386773941`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.123105625617661`", ",", "2.449489742783178`", ",", "0.`", ",", 
     "2.449489742783178`", ",", "1.`", ",", "4.47213595499958`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5.385164807134504`", ",", "4.47213595499958`", ",", "2.449489742783178`",
      ",", "0.`", ",", "3.3166247903554003`", ",", "4.69041575982343`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.741657386773941`", ",", "1.7320508075688772`", ",", "1.`", ",", 
     "3.3166247903554003`", ",", "0.`", ",", "4.58257569495584`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23606797749979`", ",", "3.741657386773941`", ",", "4.47213595499958`", 
     ",", "4.69041575982343`", ",", "4.58257569495584`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.620378771762339*^9, 3.620433934908086*^9, 
  3.621546855363385*^9, 3.621679903219749*^9, 3.621741531031393*^9, 
  3.6223522747669697`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{"\"\<sample.dmat\>\"", ",", "sampleDmat", ",", "\"\<TSV\>\""}], 
   "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6090541407301683`*^9, 3.609054190943975*^9}, {
  3.6144654124464693`*^9, 3.614465415611315*^9}, {3.620378775446268*^9, 
  3.6203787794215*^9}, {3.620433937704143*^9, 3.6204339409741917`*^9}, {
  3.621679896064539*^9, 3.621679909778816*^9}, {3.6217415251889772`*^9, 
  3.621741555008231*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Medoid DistanceMatrix", "Section",
 CellChangeTimes->{{3.609053643940978*^9, 3.609053662195283*^9}, {
  3.620378833046019*^9, 3.620378844957066*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"findMedoidsParCL", "[", 
  RowBox[{"sampleDmat", ",", "fc"}], "]"}]], "Input",
 CellChangeTimes->{{3.62037884734161*^9, 3.620378872281969*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.620378873446005*^9, 3.62043394824135*^9, 
  3.621546887185319*^9, 3.621679925028111*^9, 3.62174156981351*^9, 
  3.622352281569491*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"medoids", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"orgIndexFromMedoidParCL", "[", 
    RowBox[{"fc", ",", 
     RowBox[{"findMedoidsParCL", "[", 
      RowBox[{"sampleDmat", ",", "fc"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.620378893967937*^9, 3.620378919337583*^9}, {
  3.6203790744171886`*^9, 3.62037907820644*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "5", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.6203789042355556`*^9, 3.620378922871971*^9}, 
   3.620379078844789*^9, 3.620433948318037*^9, 3.621546887438611*^9, 
   3.6216799250996037`*^9, 3.621741569849362*^9, 3.622352281605734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleMDmat", "=", 
  RowBox[{"subDMat", "[", 
   RowBox[{"sampleDmat", ",", "medoids"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.620378985375326*^9, 3.620379017945471*^9}, {
  3.620379082147838*^9, 3.620379085266633*^9}, {3.620433971706118*^9, 
  3.6204339810919437`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "3.741657386773941`", ",", "5.385164807134504`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.741657386773941`", ",", "0.`", ",", "3.3166247903554003`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.385164807134504`", ",", "3.3166247903554003`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.620379010299436*^9, 3.620379018279426*^9}, 
   3.6203790859686337`*^9, 3.620433948356328*^9, 3.620433988224655*^9, 
   3.6215468875855722`*^9, 3.621679925157358*^9, 3.621741569877407*^9, 
   3.622352281621521*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<sample_m.dmat\>\"", ",", "sampleMDmat", ",", "\"\<TSV\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.620433994811695*^9, 3.620434004352415*^9}, {
  3.620434365900968*^9, 3.6204343705318203`*^9}, {3.621546895565247*^9, 
  3.621546907559647*^9}, {3.62167991844024*^9, 3.621679931403577*^9}, {
  3.621741564262823*^9, 3.6217415667826967`*^9}}],

Cell[BoxData["\<\"sample_m.dmat\"\>"], "Output",
 CellChangeTimes->{3.621546898566081*^9, 3.621679925197914*^9, 
  3.621741569894183*^9, 3.622352281714776*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cluster DistanceMatrix", "Section",
 CellChangeTimes->{{3.609053643940978*^9, 3.609053662195283*^9}, {
  3.620378833046019*^9, 3.620378844957066*^9}, {3.62043390033357*^9, 
  3.6204339038834553`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleCLDmat", "=", 
  RowBox[{"clDmat", "[", 
   RowBox[{"sampleDmat", ",", "fc"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.620434288674099*^9, 3.620434337009284*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "2.23606797749979`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.23606797749979`", ",", "0.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "2.449489742783178`", ",", "1.7320508075688772`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.449489742783178`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.7320508075688772`", ",", "1.`", ",", "0.`"}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"{", "0.`", "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.620434304923975*^9, 3.620434338517867*^9, 
  3.621546913255615*^9, 3.621679937191873*^9, 3.6217415871518908`*^9, 
  3.622352287144514*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<sample_cl-\>\"", "<>", 
      RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<.dmat\>\""}], ",", 
     RowBox[{"sampleCLDmat", "[", 
      RowBox[{"[", "n", "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Length", "[", "sampleCLDmat", "]"}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.6204343547204237`*^9, 3.620434478305634*^9}, {
  3.621679941887735*^9, 3.621679944612823*^9}, {3.621741581982486*^9, 
  3.6217415846625147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"sample_cl-1.dmat\"\>", ",", "\<\"sample_cl-2.dmat\"\>", 
   ",", "\<\"sample_cl-3.dmat\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.6204344901974163`*^9, 3.621546913563246*^9, 
  3.621679937263012*^9, 3.62174158722226*^9, 3.622352287204033*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pi", "Section",
 CellChangeTimes->{{3.609059120501997*^9, 3.6090591338673077`*^9}, {
  3.610861652932088*^9, 3.610861654351137*^9}, {3.614471374940921*^9, 
  3.614471378100791*^9}, {3.61447453285259*^9, 3.614474547905717*^9}, {
  3.620083531099291*^9, 3.620083547150549*^9}, {3.620378134291504*^9, 
  3.620378135190873*^9}}],

Cell[TextData[{
 "Pi = K ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox["\[Product]", 
     RowBox[{"i", "=", "1"}], "K"], 
    SuperscriptBox[
     RowBox[{"n", "[", "i", "]"}], 
     FractionBox[
      RowBox[{"r", "[", "i", "]"}], "R"]]}], TraditionalForm]]],
 "\nK :  \:30af\:30e9\:30b9\:30bf\:6570; n[i] : \:30af\:30e9\:30b9\:30bfi\
\:306e\:30e1\:30f3\:30d0\:30fc\:6570; r[i] : \:30af\:30e9\:30b9\:30bfi\:306e\
\:5e73\:5747\:534a\:5f84; R : \
\:5168\:30b5\:30f3\:30d7\:30eb\:306e\:30bb\:30f3\:30bf\:30fc\:304b\:3089\:306e\
\:5e73\:5747\:534a\:5f84\n\
pi[<\:30aa\:30ea\:30b8\:30ca\:30eb\:30c7\:30fc\:30bf>,<",
 "\:30af\:30e9\:30b9\:30bf\:30ea\:30f3\:30b0",
 "\:7d50\:679c>]"
}], "Text",
 CellChangeTimes->{{3.620084146123774*^9, 3.62008418028831*^9}, {
  3.620084224437798*^9, 3.620084224481432*^9}, {3.620084258307352*^9, 
  3.620084530227878*^9}, {3.620084631120598*^9, 3.620084692176971*^9}, {
  3.620086231653138*^9, 3.6200862374708223`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"averageDist", "[", "l_", "]"}], ":=", 
  RowBox[{"Mean", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"EuclideanDistance", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mean", "[", "l", "]"}]}], "]"}], "&"}], ",", "l"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.564882850625701*^9, 3.564882912746591*^9}, {
  3.564882942906044*^9, 3.564882979647833*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WCSPowerWeighted", "[", "cl_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "#", "]"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"averageDist", "[", "#", "]"}], "/", 
           RowBox[{"averageDist", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"cl", ",", "1"}], "]"}], "]"}]}], ")"}]}], "&"}], ",", 
       "cl"}], "]"}], ",", "Times"}], "]"}], "*", 
   RowBox[{"Length", "[", "cl", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5764832846580353`*^9, 3.576483384827096*^9}, {
  3.576483482615287*^9, 3.5764834904462633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pi", "[", 
   RowBox[{"mat_", ",", "cls_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "classes", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"classes", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "cls"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WCSPowerWeighted", "[", "classes", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.620087685085243*^9, 3.620087699437744*^9}, {
   3.6200877371707*^9, 3.620087792961706*^9}, 3.620087838936178*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pi2", "[", 
   RowBox[{"mat_", ",", "cls_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numMem", ",", "numCL", ",", "numsCLMem", ",", "totalCenter", ",", 
      "totalRmean", ",", "classes", ",", "centers", ",", "rs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numMem", "=", 
      RowBox[{"Length", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numCL", "=", 
      RowBox[{"Length", "[", "cls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numsCLMem", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", "cls"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totalCenter", "=", 
      RowBox[{"Mean", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totalRmean", "=", 
      RowBox[{"Mean", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"#", ",", "totalCenter"}], "]"}], "&"}], ",", "mat"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"classes", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "cls"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centers", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Mean", ",", "classes"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"rs", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"EuclideanDistance", "[", 
              RowBox[{"#", ",", 
               RowBox[{"centers", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "&"}], ",", 
            RowBox[{"classes", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "numCL"}], "}"}]}], "]"}], "/", "totalRmean"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"numCL", " ", "*", " ", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"numsCLMem", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "^", 
           RowBox[{"rs", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "numCL"}], "}"}]}], "]"}], ",", "Times"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.620084568484619*^9, 3.620084611819232*^9}, {
   3.620086284324086*^9, 3.6200863057028418`*^9}, {3.620086348383914*^9, 
   3.620086578266265*^9}, {3.620086612438941*^9, 3.620087207803844*^9}, {
   3.620087245312601*^9, 3.6200872839907084`*^9}, {3.620087418653158*^9, 
   3.6200876658182898`*^9}, 3.620087842369239*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pi", "[", 
  RowBox[{
   RowBox[{"sample", "//", "N"}], ",", "fc"}], "]"}]], "Input",
 CellChangeTimes->{{3.62008630860525*^9, 3.6200863233968287`*^9}, {
  3.620087221786809*^9, 3.620087222156085*^9}}],

Cell[BoxData["6.854010189597067`"], "Output",
 CellChangeTimes->{
  3.620086323889955*^9, 3.620086455206905*^9, 3.620086581458984*^9, {
   3.6200866819381733`*^9, 3.620086705513041*^9}, {3.620086833505666*^9, 
   3.6200869084680157`*^9}, {3.620086999768594*^9, 3.620087026563096*^9}, {
   3.620087154766473*^9, 3.620087179799341*^9}, {3.6200872106665688`*^9, 
   3.620087222642521*^9}, 3.620087429740432*^9, {3.620087478168626*^9, 
   3.6200874928419456`*^9}, {3.620087563218257*^9, 3.620087670154513*^9}, 
   3.620376861172304*^9, 3.6216799648998737`*^9, 3.621741600355319*^9, 
   3.622352292467162*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pi2", "[", 
  RowBox[{
   RowBox[{"sample", "//", "N"}], ",", "fc"}], "]"}]], "Input",
 CellChangeTimes->{{3.620087870167183*^9, 3.620087877937058*^9}}],

Cell[BoxData["6.854010189597067`"], "Output",
 CellChangeTimes->{3.620087879867115*^9, 3.620376861188921*^9, 
  3.621679964923779*^9, 3.621741600372546*^9, 3.622352292485231*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["mstPi", "Section",
 CellChangeTimes->{{3.609059120501997*^9, 3.6090591338673077`*^9}, {
  3.610861652932088*^9, 3.610861654351137*^9}, {3.614471374940921*^9, 
  3.614471378100791*^9}, {3.61447453285259*^9, 3.614474547905717*^9}, {
  3.620083531099291*^9, 3.620083547150549*^9}, {3.620377389163045*^9, 
  3.620377389604134*^9}, {3.620378454890738*^9, 3.6203784560085907`*^9}}],

Cell[TextData[{
 "mstPi = K ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox["\[Product]", 
     RowBox[{"i", "=", "1"}], "K"], 
    SuperscriptBox[
     RowBox[{"n", "[", "i", "]"}], 
     FractionBox[
      RowBox[{"max", "(", 
       RowBox[{"mst", "[", "i", "]"}], ")"}], 
      RowBox[{"min", "(", "MSTm", ")"}]]]}], TraditionalForm]]],
 "\nK :  \:30af\:30e9\:30b9\:30bf\:6570; n[i] : \:30af\:30e9\:30b9\:30bfi\
\:306e\:30e1\:30f3\:30d0\:30fc\:6570; max(mst[i]) : \:30af\:30e9\:30b9\:30bfi\
\:306eMST\:306e\:6700\:5927\:30a8\:30c3\:30b8; min(MSTm) : \:5404\:30af\:30e9\
\:30b9\:30bfmedoid\:306b\:3088\:308bMST\:306e\:6700\:5c0f\:30a8\:30c3\:30b8, \
mst[i]\:3068n[i]\:306f\:5bfe\:5fdc\:3059\:308b\:5fc5\:8981\:304c\:3042\:308b\
\:3002\npi[<mst_List>,<MSTm>,<\:30af\:30e9\:30b9\:30bf\:30ea\:30f3\:30b0\:7d50\
\:679c>];\[LineSeparator]mst: (n[i] * 3 \:884c\:5217) * \
K;\[LineSeparator]MSTm: K * 3 ",
 "\:884c\:5217"
}], "Text",
 CellChangeTimes->{{3.620377396100799*^9, 3.6203774121177263`*^9}, {
  3.620377454291355*^9, 3.62037752233988*^9}, {3.6203776196864853`*^9, 
  3.6203777289244833`*^9}, {3.620377761676034*^9, 3.6203778129425287`*^9}, {
  3.6203791535808077`*^9, 3.620379155659631*^9}, {3.621074741964085*^9, 
  3.621074772873204*^9}, {3.6210748150571423`*^9, 3.621074848967935*^9}, {
  3.621546517768826*^9, 3.6215466311612043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mstPi", "[", 
   RowBox[{"mst_List", ",", "mstm_", ",", "cls_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", "numMems", ",", "mstmaxs", ",", "MSTmmin"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"k", "=", 
      RowBox[{"Length", "[", "cls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numMems", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "#", "]"}], "&"}], ",", "cls"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"mstmaxs", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", "#", "]"}], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "&"}], ",", "mst", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MSTmmin", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "&"}], ",", "mstm"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"k", " ", 
      RowBox[{"Inner", "[", 
       RowBox[{"Power", ",", "numMems", ",", 
        RowBox[{"mstmaxs", "/", "MSTmmin"}], ",", "Times"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.621546434676688*^9, 3.62154648509336*^9}, 
   3.6215474230557957`*^9, {3.621744915433819*^9, 3.621744971446128*^9}, {
   3.621745016406398*^9, 3.6217450298598557`*^9}, {3.621745096746964*^9, 
   3.6217451598507977`*^9}, {3.621745215749373*^9, 3.6217454139382553`*^9}, {
   3.621745524701824*^9, 3.621745527569223*^9}, {3.621745559724021*^9, 
   3.6217456616435013`*^9}, {3.6217457131397552`*^9, 3.621745735897725*^9}, {
   3.622352436401373*^9, 3.622352439137253*^9}, 3.622352487537071*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"readMSTFiles", "[", 
   RowBox[{"dir_", ",", "fileHead_", ",", "suffix_", ",", "numCLs_"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"targetDir", ",", "targetFileNames"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"targetDir", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "dir", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{"targetDir", "=", "dir"}], ",", 
        RowBox[{"targetDir", "=", 
         RowBox[{"dir", "<>", "\"\</\>\""}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"targetFileNames", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"targetDir", "<>", "fileHead", "<>", 
         RowBox[{"ToString", "[", "i", "]"}], "<>", "suffix"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "numCLs"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "targetFileNames", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"#", ",", "\"\<Table\>\""}], "]"}], "&"}], ",", 
       "targetFileNames"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.621547078202001*^9, 3.621547182375407*^9}, {
   3.621547218554742*^9, 3.6215473005832872`*^9}, {3.62154733329757*^9, 
   3.621547336470154*^9}, {3.621547521061561*^9, 3.621547549476028*^9}, {
   3.6215476174259653`*^9, 3.6215476504942923`*^9}, 3.621547692403549*^9, {
   3.6215477486632233`*^9, 3.621547755178915*^9}, {3.621547820523614*^9, 
   3.621547827393681*^9}, {3.621547858963525*^9, 3.621547933834319*^9}, {
   3.621547989289447*^9, 3.621548046258276*^9}, {3.6215481312519827`*^9, 
   3.62154818029851*^9}, {3.621548290043548*^9, 3.62154858912365*^9}, {
   3.621548652960937*^9, 3.6215486544229317`*^9}, {3.6215486874170303`*^9, 
   3.621548746380444*^9}, {3.6215487773114223`*^9, 3.621548797337946*^9}}],

Cell["\<\
\:5b9f\:884c\:30b3\:30de\:30f3\:30c9:
MST_group.sh sample_cl 3\
\>", "Text",
 CellChangeTimes->{{3.621744812291997*^9, 3.6217448543361073`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mst", "=", 
  RowBox[{"readMSTFiles", "[", 
   RowBox[{
   "\"\<\>\"", ",", "\"\<sample_cl-\>\"", ",", "\"\<.MST\>\"", ",", "3"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6215479654778976`*^9, 3.621547976979239*^9}, {
  3.621548055880211*^9, 3.621548105629607*^9}, {3.621548192426938*^9, 
  3.62154819498282*^9}, {3.621548463227141*^9, 3.621548467743775*^9}, {
  3.62154860412321*^9, 3.621548605298089*^9}, {3.6217441300247498`*^9, 
  3.6217441338994007`*^9}, {3.6217445209714823`*^9, 3.6217445237622137`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"sample_cl-1.MST\"\>", ",", "\<\"sample_cl-2.MST\"\>", 
   ",", "\<\"sample_cl-3.MST\"\>"}], "}"}]], "Print",
 CellChangeTimes->{3.621744135129177*^9, 3.6217445249571447`*^9, 
  3.622352302320142*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2.236068`"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "1.732051`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", "1.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.621744135147031*^9, 3.621744524966251*^9, 
  3.62235230236541*^9}]
}, Open  ]],

Cell["\<\
\:5b9f\:884c\:30b3\:30de\:30f3\:30c9:
MST dmat=sample_m.dmat\
\>", "Text",
 CellChangeTimes->{{3.621744812291997*^9, 3.621744886765321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MSTm", "=", 
  RowBox[{"Import", "[", 
   RowBox[{"\"\<sample_m.MST\>\"", ",", "\"\<Table\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.62174452844195*^9, 3.621744566565427*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "3.741657`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3.316625`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6217445671851587`*^9, 3.622352302391663*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mstPi", "[", 
  RowBox[{"mst", ",", "MSTm", ",", "fc"}], "]"}]], "Input",
 CellChangeTimes->{{3.621745034929699*^9, 3.621745051584853*^9}, {
  3.6217451892671833`*^9, 3.621745192868979*^9}, {3.6223524446346607`*^9, 
  3.622352446911538*^9}}],

Cell[BoxData["8.496578738804498`"], "Output",
 CellChangeTimes->{3.622352499495492*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 656},
WindowMargins->{{16, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (2014\:5e747\
\:67089\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3621712165-5101928"->{
  Cell[4598, 133, 124, 2, 49, "Print",
   CellTags->"Info3621712165-5101928"],
  Cell[4725, 137, 1128, 30, 26, "Print",
   CellTags->"Info3621712165-5101928"]},
 "Info3621712201-5101928"->{
  Cell[6982, 202, 129, 2, 49, "Print",
   CellTags->"Info3621712201-5101928"],
  Cell[7114, 206, 1381, 38, 47, "Print",
   CellTags->"Info3621712201-5101928"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3621712165-5101928", 40806, 1124},
 {"Info3621712201-5101928", 40996, 1129}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 124, 1, 183, "Title"],
Cell[CellGroupData[{
Cell[729, 27, 150, 2, 80, "Section"],
Cell[CellGroupData[{
Cell[904, 33, 447, 8, 57, "Input"],
Cell[1354, 43, 155, 2, 36, "Output"]
}, Open  ]],
Cell[1524, 48, 522, 10, 57, "Input"],
Cell[2049, 60, 570, 11, 57, "Input"],
Cell[2622, 73, 272, 7, 57, "Input"],
Cell[2897, 82, 285, 7, 57, "Input"],
Cell[3185, 91, 259, 5, 57, "Input"],
Cell[3447, 98, 287, 7, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3771, 110, 150, 2, 80, "Section"],
Cell[3924, 114, 214, 3, 37, "Text"],
Cell[4141, 119, 286, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[4452, 127, 121, 2, 35, "Input"],
Cell[CellGroupData[{
Cell[4598, 133, 124, 2, 49, "Print",
 CellTags->"Info3621712165-5101928"],
Cell[4725, 137, 1128, 30, 26, "Print",
 CellTags->"Info3621712165-5101928"]
}, Open  ]]
}, Open  ]],
Cell[5880, 171, 562, 13, 57, "Input"],
Cell[6445, 186, 366, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[6836, 196, 121, 2, 36, "Input"],
Cell[CellGroupData[{
Cell[6982, 202, 129, 2, 49, "Print",
 CellTags->"Info3621712201-5101928"],
Cell[7114, 206, 1381, 38, 47, "Print",
 CellTags->"Info3621712201-5101928"]
}, Open  ]]
}, Open  ]],
Cell[8522, 248, 823, 22, 99, "Input"],
Cell[9348, 272, 260, 3, 37, "Text"],
Cell[9611, 277, 581, 14, 57, "Input"],
Cell[10195, 293, 238, 3, 37, "Text"],
Cell[10436, 298, 1160, 28, 141, "Input"],
Cell[11599, 328, 273, 3, 37, "Text"],
Cell[11875, 333, 407, 12, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12319, 350, 191, 3, 80, "Section"],
Cell[CellGroupData[{
Cell[12535, 357, 766, 18, 162, "Input"],
Cell[13304, 377, 1349, 27, 35, "Output"]
}, Open  ]],
Cell[14668, 407, 343, 6, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15048, 418, 108, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[15181, 423, 503, 11, 57, "Input"],
Cell[15687, 436, 1244, 22, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16980, 464, 99, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[17104, 469, 404, 8, 36, "Input"],
Cell[17511, 479, 1383, 34, 141, "Output"]
}, Open  ]],
Cell[18909, 516, 473, 9, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19419, 530, 155, 2, 80, "Section"],
Cell[CellGroupData[{
Cell[19599, 536, 167, 3, 36, "Input"],
Cell[19769, 541, 311, 8, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20117, 554, 365, 8, 78, "Input"],
Cell[20485, 564, 293, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20815, 574, 298, 6, 36, "Input"],
Cell[21116, 582, 621, 15, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21774, 602, 397, 7, 36, "Input"],
Cell[22174, 611, 159, 2, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22382, 619, 206, 3, 80, "Section"],
Cell[CellGroupData[{
Cell[22613, 626, 193, 4, 36, "Input"],
Cell[22809, 632, 824, 23, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23670, 660, 601, 15, 57, "Input"],
Cell[24274, 677, 290, 5, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24613, 688, 330, 5, 80, "Section"],
Cell[24946, 695, 967, 23, 121, "Text"],
Cell[25916, 720, 429, 12, 36, "Input"],
Cell[26348, 734, 726, 20, 78, "Input"],
Cell[27077, 756, 677, 18, 99, "Input"],
Cell[27757, 776, 2908, 74, 330, "Input"],
Cell[CellGroupData[{
Cell[30690, 854, 225, 5, 36, "Input"],
Cell[30918, 861, 604, 9, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31559, 875, 176, 4, 36, "Input"],
Cell[31738, 881, 178, 2, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31965, 889, 381, 5, 80, "Section"],
Cell[32349, 896, 1361, 28, 195, "Text"],
Cell[33713, 926, 2067, 51, 183, "Input"],
Cell[35783, 979, 2057, 46, 204, "Input"],
Cell[37843, 1027, 154, 4, 61, "Text"],
Cell[CellGroupData[{
Cell[38022, 1035, 539, 10, 36, "Input"],
Cell[38564, 1047, 243, 5, 26, "Print"],
Cell[38810, 1054, 534, 16, 35, "Output"]
}, Open  ]],
Cell[39359, 1073, 150, 4, 61, "Text"],
Cell[CellGroupData[{
Cell[39534, 1081, 205, 4, 36, "Input"],
Cell[39742, 1087, 273, 7, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40052, 1099, 265, 5, 35, "Input"],
Cell[40320, 1106, 87, 1, 35, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
