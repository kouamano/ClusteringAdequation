(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30110,        873]
NotebookOptionsPosition[     26965,        759]
NotebookOutlinePosition[     27330,        775]
CellTagsIndexPosition[     27287,        772]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[" Amano-Wada clustering validity indices", "Title",
 CellChangeTimes->{{3.620376702168819*^9, 3.6203767374970922`*^9}}],

Cell[CellGroupData[{

Cell["\:6e96\:5099", "Section",
 CellChangeTimes->{{3.609058534994502*^9, 3.6090585451601887`*^9}, {
  3.610262271780499*^9, 3.6102622771150017`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/kouamano/gitsrc/ClusteringAdequation/test-data\>\"", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6090539953716784`*^9, 3.6090540147200403`*^9}, {
  3.609660175646903*^9, 3.609660178464222*^9}, {3.610861499017685*^9, 
  3.610861501894782*^9}, {3.620376794670936*^9, 3.6203767973417892`*^9}, {
  3.6204331147782*^9, 3.6204331190629673`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/amanokou/gitsrc/ClusteringAdequation/test-data\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6090539953716784`*^9, 3.6090540147200403`*^9}, {
  3.6096601679090557`*^9, 3.609660170534235*^9}, {3.614464793646913*^9, 
  3.614464797086253*^9}, {3.620433124038519*^9, 3.620433126598084*^9}}],

Cell[BoxData["\<\"/Users/amanokou/gitsrc/ClusteringAdequation/test-data\"\>"],\
 "Output",
 CellChangeTimes->{3.620433130709476*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "SetDirectory", "[", 
   "\"\</home/kamano/gitsrc/ClusteringAdequation/test-data\>\"", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6090539953716784`*^9, 3.6090540147200403`*^9}, {
  3.6096601679090557`*^9, 3.609660170534235*^9}, {3.614461158477817*^9, 
  3.614461167742083*^9}, {3.617946347522086*^9, 3.617946353155634*^9}, {
  3.617956900286704*^9, 3.617956929585043*^9}, {3.620376788873835*^9, 
  3.6203767877031918`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Get", "[", 
   "\"\</home/kamano/gitsrc/MATH_SCRIPT/SCRIPTS/ConnectiveClass.txt\>\"", 
   "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.61795693883834*^9, 3.617956959530879*^9}, {
  3.618093482154457*^9, 3.618093485413845*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:57fa\:672cProgram\:307e\:3068\:3081", "Section",
 CellChangeTimes->{{3.609058534994502*^9, 3.6090585451601887`*^9}, 
   3.610861724725685*^9}],

Cell["\:8ddd\:96e2\:884c\:5217\:304b\:3089\:7279\:5b9a\:306e\:30af\:30e9\:30b9\
\:30bf\:306b\:95a2\:3059\:308b\:90e8\:5206\:8ddd\:96e2\:884c\:5217\:3092\:629c\
\:304d\:51fa\:3059\:3002", "Text",
 CellChangeTimes->{{3.609058575911153*^9, 3.609058595814891*^9}, 
   3.609058854575791*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subDMat", "[", 
   RowBox[{"dmat_", ",", "members_"}], "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"dmat", "[", 
      RowBox[{"[", "members", "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "members", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609056678594493*^9, 3.609056700384342*^9}, {
  3.60905676006923*^9, 3.609056765362728*^9}, {3.609056832760825*^9, 
  3.609056855182769*^9}}],

Cell["\:90e8\:5206\:8ddd\:96e2\:884c\:5217\:3092\:3082\:3068\:306b\:7279\:5b9a\
\:306e\:30af\:30e9\:30b9\:30bf\:306eargmin\:3092\:6c42\:3081\:308b(minindex)\
\:3002", "Text",
 CellChangeTimes->{
  3.609058627689025*^9, {3.60905866170156*^9, 3.6090587224749527`*^9}, {
   3.609058818897526*^9, 3.609058837351091*^9}, {3.614467269090719*^9, 
   3.614467273866247*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"argMinDMat", "[", "dmat_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sumList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sumList", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Tr", "[", "#", "]"}], "&"}], ",", "dmat"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"sumList", ",", 
        RowBox[{"Min", "[", "sumList", "]"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.609056304994347*^9, 3.609056530187052*^9}, {
  3.610875972857506*^9, 3.6108759778486767`*^9}}],

Cell["\:8ddd\:96e2\:884c\:5217\:3068\:30af\:30e9\:30b9\:30bf\:30ea\:30f3\:30b0\
\:7d50\:679c\:304b\:3089\:5404\:30af\:30e9\:30b9\:30bf\:306emedoid\:3092\:3082\
\:3068\:3081\:308b\:3002", "Text",
 CellChangeTimes->{{3.609058780134366*^9, 3.609058815201708*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findMedoidsParCL", "[", 
   RowBox[{"dmat_", ",", "clusterResult_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"argMinDMat", "[", 
      RowBox[{"subDMat", "[", 
       RowBox[{"dmat", ",", "#"}], "]"}], "]"}], "&"}], ",", 
    "clusterResult"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.609057466853734*^9, 3.6090575207806053`*^9}, {
  3.609057674007146*^9, 3.609057764648025*^9}, {3.6090578275073643`*^9, 
  3.60905783014426*^9}}],

Cell["\:5404\:30af\:30e9\:30b9\:30bf\:306emedoid\:756a\:53f7\:304b\:3089\:3082\
\:3068\:306e\:30b5\:30f3\:30d7\:30eb\:756a\:53f7\:3092\:6c42\:3081\:308b\:3002\
", "Text",
 CellChangeTimes->{{3.609058867427833*^9, 3.6090589056302032`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"orgIndexFromMedoidParCL", "[", 
   RowBox[{"clusterResult_", ",", "medoids_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "fmedoids"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", "=", 
      RowBox[{"Length", "[", "medoids", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fmedoids", "=", 
      RowBox[{"Flatten", "[", "medoids", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"clusterResult", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"medoids", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "l"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6108776036575823`*^9, 3.6108776037305117`*^9}, {
  3.610877636024678*^9, 3.6108777357516747`*^9}, {3.6108777909007807`*^9, 
  3.610877846323398*^9}}],

Cell["\:8ddd\:96e2\:884c\:5217\:304b\:3089\:5404\:30af\:30e9\:30b9\:30bf\:306e\
\:90e8\:5206\:8ddd\:96e2\:884c\:5217\:3092\:6c42\:3081\:308b\:3002", "Text",
 CellChangeTimes->{{3.609058867427833*^9, 3.6090589056302032`*^9}, {
  3.620434159707165*^9, 3.620434195395053*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"clDmat", "[", 
   RowBox[{"dmat_", ",", "cls_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"subDMat", "[", 
      RowBox[{"dmat", ",", "#"}], "]"}], "&"}], ",", "cls"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.620434214310219*^9, 3.620434278964068*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sample", "Section",
 CellChangeTimes->{{3.606034047507456*^9, 3.6060340797165213`*^9}, {
  3.609053084765521*^9, 3.609053104466848*^9}, {3.609053522827886*^9, 
  3.609053528282591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sample", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "5"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.609053452988316*^9, 3.609053503577524*^9}, {
  3.609054032501409*^9, 3.6090540393877163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.609053505553536*^9, 3.609054040410921*^9, 
  3.6096638213373327`*^9, 3.609668730183543*^9, 3.609668771849215*^9, 
  3.610262326625971*^9, 3.610861576612458*^9, 3.6108731820294333`*^9, 
  3.610877985707665*^9, 3.610878085841566*^9, 3.610878373023477*^9, 
  3.6108791352170258`*^9, 3.613895915147768*^9, 3.613898805021328*^9, 
  3.6144612386683483`*^9, 3.61446486194488*^9, 3.614467296721122*^9, 
  3.614471284293571*^9, 3.6144747672159433`*^9, 3.614475015934491*^9, 
  3.614475287912785*^9, 3.617946297079073*^9, 3.61794675316822*^9, 
  3.617946968471789*^9, 3.617947175716967*^9, 3.6180935688415327`*^9, 
  3.6180945465525846`*^9, 3.619832105618229*^9, 3.620086247217595*^9, 
  3.620376861093351*^9, 3.620378575432207*^9, 3.620378761220354*^9, 
  3.620433142564592*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FindClusters Examples", "Section",
 CellChangeTimes->{{3.606034047507456*^9, 3.6060340797165213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fc", "=", 
  RowBox[{"FindClusters", "[", 
   RowBox[{
    RowBox[{"sample", "\[Rule]", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "sample", "]"}], "]"}]}], ",", "3", ",", 
    RowBox[{"Method", "\[Rule]", "\"\<Agglomerate\>\""}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.606033793015903*^9, 3.60603383291689*^9}, {
  3.6060340218805227`*^9, 3.606034026947016*^9}, {3.609053554501706*^9, 
  3.609053586885703*^9}, {3.609056788739505*^9, 3.609056804396954*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.60603383365833*^9, 3.6060340278139544`*^9, {3.609053572420772*^9, 
   3.609053587743553*^9}, 3.609054044581629*^9, {3.609056790475038*^9, 
   3.6090568049956627`*^9}, 3.609663825135777*^9, 3.6096687347618856`*^9, 
   3.6096687766568336`*^9, 3.610262331654888*^9, 3.610861580007556*^9, 
   3.610873182081625*^9, 3.6108779857609158`*^9, 3.6108780858792152`*^9, 
   3.6108783730763807`*^9, 3.610879135271751*^9, 3.61389591865784*^9, 
   3.613898808711843*^9, 3.6144612456465893`*^9, 3.614464867282531*^9, 
   3.6144673041355247`*^9, 3.614471289299634*^9, 3.6144747677600403`*^9, 
   3.614475016139241*^9, 3.6144752881598063`*^9, 3.617946300769215*^9, 
   3.617946757458857*^9, 3.6179469714101753`*^9, 3.617947179365067*^9, 
   3.618093576079946*^9, 3.618094553463169*^9, 3.61983210963229*^9, 
   3.62008626486449*^9, 3.620376861114264*^9, 3.6203785820941753`*^9, 
   3.620378802673603*^9, 3.620433145126238*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DistanceMatrix", "Section",
 CellChangeTimes->{{3.609053643940978*^9, 3.609053662195283*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleDmat", "=", 
  RowBox[{"Outer", "[", 
   RowBox[{"EuclideanDistance", ",", 
    RowBox[{"sample", "//", "N"}], ",", "sample", ",", "1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6090536736254387`*^9, 3.6090537092594967`*^9}, {
  3.609053844719688*^9, 3.609053902141259*^9}, {3.609053934821576*^9, 
  3.609053953519042*^9}, {3.609054158820077*^9, 3.609054164549304*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "2.23606797749979`", ",", "4.123105625617661`", ",", 
     "5.385164807134504`", ",", "3.741657386773941`", ",", 
     "2.23606797749979`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23606797749979`", ",", "0.`", ",", "2.449489742783178`", ",", 
     "4.47213595499958`", ",", "1.7320508075688772`", ",", 
     "3.741657386773941`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.123105625617661`", ",", "2.449489742783178`", ",", "0.`", ",", 
     "2.449489742783178`", ",", "1.`", ",", "4.47213595499958`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5.385164807134504`", ",", "4.47213595499958`", ",", "2.449489742783178`",
      ",", "0.`", ",", "3.3166247903554003`", ",", "4.69041575982343`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.741657386773941`", ",", "1.7320508075688772`", ",", "1.`", ",", 
     "3.3166247903554003`", ",", "0.`", ",", "4.58257569495584`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "2.23606797749979`", ",", "3.741657386773941`", ",", "4.47213595499958`", 
     ",", "4.69041575982343`", ",", "4.58257569495584`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.620378771762339*^9, 3.620433934908086*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{"\"\<sample.dmat\>\"", ",", "sampleDmat", ",", "\"\<TSV\>\""}], 
   "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6090541407301683`*^9, 3.609054190943975*^9}, {
  3.6144654124464693`*^9, 3.614465415611315*^9}, {3.620378775446268*^9, 
  3.6203787794215*^9}, {3.620433937704143*^9, 3.6204339409741917`*^9}}],

Cell[BoxData["\<\"sample.dmat\"\>"], "Output",
 CellChangeTimes->{3.62037878048888*^9, 3.620433935148259*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Medoid DistanceMatrix", "Section",
 CellChangeTimes->{{3.609053643940978*^9, 3.609053662195283*^9}, {
  3.620378833046019*^9, 3.620378844957066*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"findMedoidsParCL", "[", 
  RowBox[{"sampleDmat", ",", "fc"}], "]"}]], "Input",
 CellChangeTimes->{{3.62037884734161*^9, 3.620378872281969*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.620378873446005*^9, 3.62043394824135*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"medoids", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"orgIndexFromMedoidParCL", "[", 
    RowBox[{"fc", ",", 
     RowBox[{"findMedoidsParCL", "[", 
      RowBox[{"sampleDmat", ",", "fc"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.620378893967937*^9, 3.620378919337583*^9}, {
  3.6203790744171886`*^9, 3.62037907820644*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "5", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.6203789042355556`*^9, 3.620378922871971*^9}, 
   3.620379078844789*^9, 3.620433948318037*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleMDmat", "=", 
  RowBox[{"subDMat", "[", 
   RowBox[{"sampleDmat", ",", "medoids"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.620378985375326*^9, 3.620379017945471*^9}, {
  3.620379082147838*^9, 3.620379085266633*^9}, {3.620433971706118*^9, 
  3.6204339810919437`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "3.741657386773941`", ",", "5.385164807134504`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.741657386773941`", ",", "0.`", ",", "3.3166247903554003`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.385164807134504`", ",", "3.3166247903554003`", ",", "0.`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.620379010299436*^9, 3.620379018279426*^9}, 
   3.6203790859686337`*^9, 3.620433948356328*^9, 3.620433988224655*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{"\"\<sample_m.dmat\>\"", ",", "sampleMDmat", ",", "\"\<TSV\>\""}], 
   "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.620433994811695*^9, 3.620434004352415*^9}, {
  3.620434365900968*^9, 3.6204343705318203`*^9}}],

Cell[BoxData["\<\"sample_m.dmat\"\>"], "Output",
 CellChangeTimes->{3.620434005903163*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cluster DistanceMatrix", "Section",
 CellChangeTimes->{{3.609053643940978*^9, 3.609053662195283*^9}, {
  3.620378833046019*^9, 3.620378844957066*^9}, {3.62043390033357*^9, 
  3.6204339038834553`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sampleCLDmat", "=", 
  RowBox[{"clDmat", "[", 
   RowBox[{"sampleDmat", ",", "fc"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.620434288674099*^9, 3.620434337009284*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "2.23606797749979`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.23606797749979`", ",", "0.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "2.449489742783178`", ",", "1.7320508075688772`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.449489742783178`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.7320508075688772`", ",", "1.`", ",", "0.`"}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"{", "0.`", "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.620434304923975*^9, 3.620434338517867*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<sample_cl-\>\"", "<>", 
      RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\<.dmat\>\""}], ",", 
     RowBox[{"sampleCLDmat", "[", 
      RowBox[{"[", "n", "]"}], "]"}], ",", "\"\<TSV\>\""}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", 
     RowBox[{"Length", "[", "sampleCLDmat", "]"}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.6204343547204237`*^9, 3.620434478305634*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"sample_cl-1.dmat\"\>", ",", "\<\"sample_cl-2.dmat\"\>", 
   ",", "\<\"sample_cl-3.dmat\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.6204344901974163`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pi", "Section",
 CellChangeTimes->{{3.609059120501997*^9, 3.6090591338673077`*^9}, {
  3.610861652932088*^9, 3.610861654351137*^9}, {3.614471374940921*^9, 
  3.614471378100791*^9}, {3.61447453285259*^9, 3.614474547905717*^9}, {
  3.620083531099291*^9, 3.620083547150549*^9}, {3.620378134291504*^9, 
  3.620378135190873*^9}}],

Cell[TextData[{
 "Pi = K ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox["\[Product]", 
     RowBox[{"i", "=", "1"}], "K"], 
    SuperscriptBox[
     RowBox[{"n", "[", "i", "]"}], 
     FractionBox[
      RowBox[{"r", "[", "i", "]"}], "R"]]}], TraditionalForm]]],
 "\nK :  \:30af\:30e9\:30b9\:30bf\:6570; n[i] : \:30af\:30e9\:30b9\:30bfi\
\:306e\:30e1\:30f3\:30d0\:30fc\:6570; r[i] : \:30af\:30e9\:30b9\:30bfi\:306e\
\:5e73\:5747\:534a\:5f84; R : \
\:5168\:30b5\:30f3\:30d7\:30eb\:306e\:30bb\:30f3\:30bf\:30fc\:304b\:3089\:306e\
\:5e73\:5747\:534a\:5f84\n\
pi[<\:30aa\:30ea\:30b8\:30ca\:30eb\:30c7\:30fc\:30bf>,<",
 "\:30af\:30e9\:30b9\:30bf\:30ea\:30f3\:30b0",
 "\:7d50\:679c>]"
}], "Text",
 CellChangeTimes->{{3.620084146123774*^9, 3.62008418028831*^9}, {
  3.620084224437798*^9, 3.620084224481432*^9}, {3.620084258307352*^9, 
  3.620084530227878*^9}, {3.620084631120598*^9, 3.620084692176971*^9}, {
  3.620086231653138*^9, 3.6200862374708223`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"averageDist", "[", "l_", "]"}], ":=", 
  RowBox[{"Mean", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"EuclideanDistance", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Mean", "[", "l", "]"}]}], "]"}], "&"}], ",", "l"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.564882850625701*^9, 3.564882912746591*^9}, {
  3.564882942906044*^9, 3.564882979647833*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WCSPowerWeighted", "[", "cl_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "#", "]"}], "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"averageDist", "[", "#", "]"}], "/", 
           RowBox[{"averageDist", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"cl", ",", "1"}], "]"}], "]"}]}], ")"}]}], "&"}], ",", 
       "cl"}], "]"}], ",", "Times"}], "]"}], "*", 
   RowBox[{"Length", "[", "cl", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5764832846580353`*^9, 3.576483384827096*^9}, {
  3.576483482615287*^9, 3.5764834904462633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pi", "[", 
   RowBox[{"mat_", ",", "cls_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "classes", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"classes", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "cls"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WCSPowerWeighted", "[", "classes", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.620087685085243*^9, 3.620087699437744*^9}, {
   3.6200877371707*^9, 3.620087792961706*^9}, 3.620087838936178*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pi2", "[", 
   RowBox[{"mat_", ",", "cls_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numMem", ",", "numCL", ",", "numsCLMem", ",", "totalCenter", ",", 
      "totalRmean", ",", "classes", ",", "centers", ",", "rs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numMem", "=", 
      RowBox[{"Length", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numCL", "=", 
      RowBox[{"Length", "[", "cls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numsCLMem", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", "cls"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totalCenter", "=", 
      RowBox[{"Mean", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"totalRmean", "=", 
      RowBox[{"Mean", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"#", ",", "totalCenter"}], "]"}], "&"}], ",", "mat"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"classes", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mat", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "cls"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centers", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Mean", ",", "classes"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"rs", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"EuclideanDistance", "[", 
              RowBox[{"#", ",", 
               RowBox[{"centers", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "&"}], ",", 
            RowBox[{"classes", "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "numCL"}], "}"}]}], "]"}], "/", "totalRmean"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"numCL", " ", "*", " ", 
      RowBox[{"Tr", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"numsCLMem", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "^", 
           RowBox[{"rs", "[", 
            RowBox[{"[", "n", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "numCL"}], "}"}]}], "]"}], ",", "Times"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.620084568484619*^9, 3.620084611819232*^9}, {
   3.620086284324086*^9, 3.6200863057028418`*^9}, {3.620086348383914*^9, 
   3.620086578266265*^9}, {3.620086612438941*^9, 3.620087207803844*^9}, {
   3.620087245312601*^9, 3.6200872839907084`*^9}, {3.620087418653158*^9, 
   3.6200876658182898`*^9}, 3.620087842369239*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pi", "[", 
  RowBox[{
   RowBox[{"sample", "//", "N"}], ",", "fc"}], "]"}]], "Input",
 CellChangeTimes->{{3.62008630860525*^9, 3.6200863233968287`*^9}, {
  3.620087221786809*^9, 3.620087222156085*^9}}],

Cell[BoxData["6.854010189597067`"], "Output",
 CellChangeTimes->{
  3.620086323889955*^9, 3.620086455206905*^9, 3.620086581458984*^9, {
   3.6200866819381733`*^9, 3.620086705513041*^9}, {3.620086833505666*^9, 
   3.6200869084680157`*^9}, {3.620086999768594*^9, 3.620087026563096*^9}, {
   3.620087154766473*^9, 3.620087179799341*^9}, {3.6200872106665688`*^9, 
   3.620087222642521*^9}, 3.620087429740432*^9, {3.620087478168626*^9, 
   3.6200874928419456`*^9}, {3.620087563218257*^9, 3.620087670154513*^9}, 
   3.620376861172304*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pi2", "[", 
  RowBox[{
   RowBox[{"sample", "//", "N"}], ",", "fc"}], "]"}]], "Input",
 CellChangeTimes->{{3.620087870167183*^9, 3.620087877937058*^9}}],

Cell[BoxData["6.854010189597067`"], "Output",
 CellChangeTimes->{3.620087879867115*^9, 3.620376861188921*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["mstPi", "Section",
 CellChangeTimes->{{3.609059120501997*^9, 3.6090591338673077`*^9}, {
  3.610861652932088*^9, 3.610861654351137*^9}, {3.614471374940921*^9, 
  3.614471378100791*^9}, {3.61447453285259*^9, 3.614474547905717*^9}, {
  3.620083531099291*^9, 3.620083547150549*^9}, {3.620377389163045*^9, 
  3.620377389604134*^9}, {3.620378454890738*^9, 3.6203784560085907`*^9}}],

Cell[TextData[{
 "mstPi = K ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderoverscriptBox["\[Product]", 
     RowBox[{"i", "=", "1"}], "K"], 
    SuperscriptBox[
     RowBox[{"n", "[", "i", "]"}], 
     FractionBox[
      RowBox[{"max", "(", 
       RowBox[{"mst", "[", "i", "]"}], ")"}], 
      RowBox[{"min", "(", "MSTm", ")"}]]]}], TraditionalForm]]],
 "\nK :  \:30af\:30e9\:30b9\:30bf\:6570; n[i] : \:30af\:30e9\:30b9\:30bfi\
\:306e\:30e1\:30f3\:30d0\:30fc\:6570; max(mst[i]) : \:30af\:30e9\:30b9\:30bfi\
\:306eMST\:306e\:6700\:5c0f\:30a8\:30c3\:30b8; min(MSTm) : \:5404\:30af\:30e9\
\:30b9\:30bfmedoid\:306b\:3088\:308bMST\:306e\:6700\:5c0f\:30a8\:30c3\:30b8\n\
pi[<mst_List>,<MSTm>,<\:30af\:30e9\:30b9\:30bf\:30ea\:30f3\:30b0\:7d50\:679c>]"
}], "Text",
 CellChangeTimes->{{3.620377396100799*^9, 3.6203774121177263`*^9}, {
  3.620377454291355*^9, 3.62037752233988*^9}, {3.6203776196864853`*^9, 
  3.6203777289244833`*^9}, {3.620377761676034*^9, 3.6203778129425287`*^9}, {
  3.6203791535808077`*^9, 3.620379155659631*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 656},
WindowMargins->{{28, Automatic}, {Automatic, 22}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (2014\:5e747\
\:67089\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 124, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[729, 27, 150, 2, 64, "Section"],
Cell[882, 31, 425, 9, 28, "Input"],
Cell[CellGroupData[{
Cell[1332, 44, 347, 6, 28, "Input"],
Cell[1682, 52, 132, 2, 28, "Output"]
}, Open  ]],
Cell[1829, 57, 473, 10, 28, "Input"],
Cell[2305, 69, 272, 7, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2614, 81, 150, 2, 64, "Section"],
Cell[2767, 85, 286, 4, 30, "Text"],
Cell[3056, 91, 483, 12, 28, "Input"],
Cell[3542, 105, 366, 6, 30, "Text"],
Cell[3911, 113, 730, 20, 80, "Input"],
Cell[4644, 135, 260, 3, 30, "Text"],
Cell[4907, 140, 501, 13, 46, "Input"],
Cell[5411, 155, 238, 3, 30, "Text"],
Cell[5652, 160, 1066, 27, 114, "Input"],
Cell[6721, 189, 273, 3, 30, "Text"],
Cell[6997, 194, 327, 10, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7361, 209, 191, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[7577, 216, 766, 18, 131, "Input"],
Cell[8346, 236, 1258, 26, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9653, 268, 108, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[9786, 273, 503, 11, 28, "Input"],
Cell[10292, 286, 1148, 21, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11489, 313, 99, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[11613, 318, 404, 8, 28, "Input"],
Cell[12020, 328, 1287, 32, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13344, 365, 373, 7, 28, "Input"],
Cell[13720, 374, 109, 1, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13878, 381, 155, 2, 64, "Section"],
Cell[CellGroupData[{
Cell[14058, 387, 167, 3, 28, "Input"],
Cell[14228, 392, 218, 6, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14483, 403, 365, 8, 28, "Input"],
Cell[14851, 413, 199, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15087, 422, 298, 6, 28, "Input"],
Cell[15388, 430, 523, 13, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15948, 448, 279, 6, 28, "Input"],
Cell[16230, 456, 90, 1, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16369, 463, 206, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[16600, 470, 193, 4, 28, "Input"],
Cell[16796, 476, 728, 21, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17561, 502, 501, 13, 46, "Input"],
Cell[18065, 517, 200, 4, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18314, 527, 330, 5, 64, "Section"],
Cell[18647, 534, 967, 23, 98, "Text"],
Cell[19617, 559, 429, 12, 28, "Input"],
Cell[20049, 573, 726, 20, 63, "Input"],
Cell[20778, 595, 677, 18, 80, "Input"],
Cell[21458, 615, 2908, 74, 233, "Input"],
Cell[CellGroupData[{
Cell[24391, 693, 225, 5, 28, "Input"],
Cell[24619, 700, 532, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25188, 713, 176, 4, 28, "Input"],
Cell[25367, 719, 109, 1, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25525, 726, 381, 5, 64, "Section"],
Cell[25909, 733, 1028, 22, 100, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
